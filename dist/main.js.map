{"mappings":"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","sources":["lib/main/atomts.ts","lib/utils.ts","lib/main/atom/views/outline/semanticView.ts","lib/main/atom/views/outline/navigationTreeComponent.tsx","lib/main/atom/utils/index.ts","lib/main/atom/utils/atom.ts","lib/main/atom/utils/ts.ts","lib/main/atom/utils/highlighter.ts","lib/main/atom/views/outline/navigationNodeComponent.tsx","lib/main/atom/views/outline/navTreeUtils.ts","lib/main/pluginManager.ts","lib/client/index.ts","lib/client/clientResolver.ts","lib/client/client.ts","lib/client/callbacks.ts","lib/client/resolveBinary.ts","lib/main/atom-ide/codeActionsProvider.ts","lib/main/atom-ide/codeHighlightProvider.ts","lib/main/atom-ide/datatipProvider.tsx","lib/main/atom/tooltips/tooltipRenderer.tsx","lib/main/atom-ide/definitionsProvider.ts","lib/main/atom-ide/findReferencesProvider.ts","lib/main/atom-ide/hyperclickProvider.ts","lib/main/atom/commands/findReferences.tsx","lib/main/atom/components/tsView.tsx","lib/main/atom/views/highlightComponent.tsx","lib/main/atom/views/simpleSelectionView.tsx","lib/main/atom/commands/registry.ts","lib/main/atom/commands/goToDeclaration.tsx","lib/main/atom-ide/outlineProvider.ts","lib/main/atom-ide/sigHelpProvider.ts","lib/main/atom/autoCompleteProvider.ts","lib/main/atom/codeActionTemplate.tsx","lib/main/atom/codefix/index.ts","lib/main/atom/codefix/codefixProvider.ts","lib/main/atom/commands/refactorCode.tsx","lib/main/atom/codefix/intentionsProvider.ts","lib/main/atom/commands/index.ts","lib/main/atom/commands/build.ts","lib/main/atom/commands/checkAllFiles.ts","lib/main/atom/commands/clearErrors.ts","lib/main/atom/commands/formatCode.ts","lib/main/atom/commands/initializeConfig.ts","lib/main/atom/commands/organizeImports.ts","lib/main/atom/commands/reloadProjects.ts","lib/main/atom/commands/renameFile.ts","lib/main/atom/views/renameView.tsx","lib/main/atom/components/miniEditor.ts","lib/main/atom/commands/renameRefactor.ts","lib/main/atom/commands/restartAllServers.ts","lib/main/atom/commands/returnFromDeclaration.tsx","lib/main/atom/commands/semanticView.ts","lib/main/atom/commands/showTooltip.ts","lib/main/atom/commands/sigHelp.ts","lib/main/atom/commands/symbolsView.ts","lib/main/atom/components/statusPanel/index.tsx","lib/main/atom/components/statusPanel/buildStatus.tsx","lib/main/atom/components/statusPanel/tooltip.tsx","lib/main/atom/components/statusPanel/configPath.tsx","lib/main/atom/editorPositionHistoryManager.tsx","lib/main/atom/views/outline/semanticViewController.ts","lib/main/atom/views/symbols/symbolsViewController.ts","lib/main/atom/views/symbols/fileSymbolsView.tsx","lib/main/atom/views/symbols/generator.ts","lib/main/atom/views/symbols/symbolsTag.ts","lib/main/atom/views/symbols/utils.ts","lib/main/atom/views/symbols/projectSymbolsView.tsx","lib/main/errorPusher.ts","lib/main/typescriptEditorPane.ts","lib/main/typescriptBuffer.ts"],"sourcesContent":["import {DisposableLike} from \"atom\"\nimport {\n  BusySignalService,\n  CodeActionProvider,\n  CodeHighlightProvider,\n  DatatipService,\n  DefinitionProvider,\n  FindReferencesProvider,\n  HyperclickProvider,\n  OutlineProvider,\n  SignatureHelpRegistry,\n} from \"atom-ide-base\"\nimport * as packageDeps from \"atom-package-deps\"\nimport {AutocompleteProvider} from \"atom/autocomplete-plus\"\nimport {IndieDelegate} from \"atom/linter\"\nimport {StatusBar} from \"atom/status-bar\"\nimport etch from \"etch\"\nimport {handlePromise} from \"../utils\"\nimport {SemanticView, SemanticViewSerializationData} from \"./atom/views/outline/semanticView\"\nimport {State} from \"./packageState\"\nimport {PluginManager} from \"./pluginManager\"\n\nlet pluginManager: PluginManager | undefined\n\nexport function activate(state: State) {\n  etch.setScheduler(atom.views)\n  pluginManager = new PluginManager(state)\n\n  setImmediate(() => handlePromise(checkAndInstallDependencies()))\n}\n\nasync function checkAndInstallDependencies() {\n  const packagesProvidingUIServices = [\"atom-ide-ui\", \"linter\", \"nuclide\"]\n  if (!packagesProvidingUIServices.some((p) => atom.packages.isPackageLoaded(p))) {\n    await packageDeps.install(\"atom-typescript-updated\", true)\n  }\n}\n\nexport function deactivate() {\n  if (pluginManager) pluginManager.destroy()\n  pluginManager = undefined\n}\n\nexport function serialize() {\n  if (pluginManager) return pluginManager.serialize()\n  else return undefined\n}\n\nexport function deserializeSemanticView(serialized: SemanticViewSerializationData): SemanticView {\n  return SemanticView.create(serialized.data)\n}\n\n////////////////////////////////// Consumers ///////////////////////////////////\nexport function consumeLinter(\n  register: (opts: {name: string}) => IndieDelegate,\n): DisposableLike | void {\n  if (pluginManager) return pluginManager.consumeLinter(register)\n}\n\nexport function consumeStatusBar(statusBar: StatusBar): DisposableLike | void {\n  if (pluginManager) return pluginManager.consumeStatusBar(statusBar)\n}\n\nexport function consumeDatatipService(datatipService: DatatipService): DisposableLike | void {\n  if (pluginManager) return pluginManager.consumeDatatipService(datatipService)\n}\n\nexport function consumeSignatureHelp(registry: SignatureHelpRegistry): DisposableLike | void {\n  if (pluginManager) return pluginManager.consumeSigHelpService(registry)\n}\n\nexport function consumeBusySignal(busySignalService: BusySignalService): DisposableLike | void {\n  if (pluginManager) return pluginManager.consumeBusySignal(busySignalService)\n}\n\n////////////////////////////////// Providers ///////////////////////////////////\nexport function provideAutocomplete(): AutocompleteProvider[] | undefined {\n  if (pluginManager) return pluginManager.provideAutocomplete()\n}\n\nexport function provideIntentions() {\n  if (pluginManager) return pluginManager.provideIntentions()\n}\n\nexport function provideIntentionsHighlight() {\n  if (pluginManager) return pluginManager.provideIntentionsHighlight()\n}\n\nexport function provideCodeActions(): CodeActionProvider | undefined {\n  if (pluginManager) return pluginManager.provideCodeActions()\n}\n\nexport function provideHyperclick(): HyperclickProvider | undefined {\n  if (pluginManager) return pluginManager.provideHyperclick()\n}\n\nexport function provideReferences(): FindReferencesProvider | undefined {\n  if (pluginManager) return pluginManager.provideReferences()\n}\n\nexport function provideOutlines(): OutlineProvider | undefined {\n  if (pluginManager) return pluginManager.provideOutlines()\n}\n\nexport function provideDefinitions(): DefinitionProvider | undefined {\n  if (pluginManager) return pluginManager.provideDefinitions()\n}\n\nexport function provideCodeHighlight(): CodeHighlightProvider | undefined {\n  if (pluginManager) return pluginManager.provideCodeHighlight()\n}\n","export function handlePromise(promise: Promise<any> | undefined): void {\n  if (promise === undefined) return\n  if (typeof promise.catch !== \"function\") {\n    atom.notifications.addFatalError(\n      \"Atom-Typescript: non-promise passed to handlePromise. Please report this.\",\n      {\n        stack: new Error().stack,\n        dismissable: true,\n      },\n    )\n    return\n  }\n  promise.catch((err: Error) => {\n    atom.notifications.addFatalError(`Atom-Typescript error: ${err.message}`, {\n      detail: err.toString(),\n      stack: err.stack,\n      dismissable: true,\n    })\n  })\n}\n","import {GetClientFunction} from \"../../../../client\"\nimport {NavigationTreeComponent} from \"./navigationTreeComponent\"\nimport {NavigationTreeViewModel} from \"./semanticViewModel\"\n\nexport const SEMANTIC_VIEW_URI = \"atom-typescript://semantic-view\"\n\nexport interface SemanticViewOptions {\n  navTree: NavigationTreeViewModel | null\n}\n\nexport interface SemanticViewSerializationData {\n  data: SemanticViewOptions\n  deserializer: \"atomts-semantic-view/SemanticView\"\n}\n\nexport class SemanticView {\n  public static create(config: SemanticViewOptions) {\n    if (!SemanticView.instance) SemanticView.instance = new SemanticView(config)\n    return SemanticView.instance\n  }\n  private static instance: SemanticView | null = null\n  private comp: NavigationTreeComponent\n\n  public get element() {\n    return this.comp.element\n  }\n\n  private constructor(config: SemanticViewOptions) {\n    this.comp = new NavigationTreeComponent({navTree: config.navTree})\n  }\n\n  public async setGetClient(gc: GetClientFunction) {\n    await this.comp.setGetClient(gc)\n    await this.comp.update({})\n  }\n\n  public getTitle() {\n    return \"TypeScript\"\n  }\n\n  public getURI() {\n    return SEMANTIC_VIEW_URI\n  }\n\n  public async destroy() {\n    SemanticView.instance = null\n    await this.comp.destroy()\n  }\n\n  public getDefaultLocation() {\n    return \"right\"\n  }\n\n  public getAllowedLocations() {\n    // The locations into which the item can be moved.\n    return [\"left\", \"right\"]\n  }\n\n  public serialize(): SemanticViewSerializationData {\n    return {\n      deserializer: \"atomts-semantic-view/SemanticView\",\n      data: {navTree: this.comp.props.navTree},\n    }\n  }\n}\n","import {CompositeDisposable, Disposable, Point, TextEditor} from \"atom\"\nimport * as etch from \"etch\"\nimport {isEqual} from \"lodash\"\nimport debounce from \"lodash/debounce\"\nimport {NavigationTree} from \"typescript/lib/protocol\"\nimport {GetClientFunction} from \"../../../../client\"\nimport * as atomUtils from \"../../utils\"\nimport {NavigationNodeComponent} from \"./navigationNodeComponent\"\nimport {\n  findNodeAt,\n  getNodeStartLine,\n  getNodeStartOffset,\n  prepareNavTree,\n  restoreCollapsed,\n} from \"./navTreeUtils\"\nimport {NavigationTreeViewModel, SelectableNode, ToNodeScrollableEditor} from \"./semanticViewModel\"\n\nexport interface Props extends JSX.Props {\n  navTree: NavigationTreeViewModel | null\n}\n\nexport class NavigationTreeComponent\n  implements JSX.ElementClass, ToNodeScrollableEditor, SelectableNode\n{\n  public element!: HTMLDivElement\n  private editor?: TextEditor\n  private editorScrolling?: Disposable\n  private editorChanging?: Disposable\n  private getClient?: GetClientFunction\n  private subscriptions = new CompositeDisposable()\n  private longLineLength: number = 4000\n  private largeFileLineCount: number = 500\n\n  constructor(public props: Props) {\n    prepareNavTree(props.navTree)\n    etch.initialize(this)\n    this.subscriptions.add(\n      atom.workspace.observeActiveTextEditor(this.subscribeToEditor),\n      atom.commands.add(\"atom-text-editor.typescript-editor\" as \"atom-text-editor\", {\n        \"typescript:reveal-in-semantic-view\": {\n          description: \"Reveal the symbol under the text cursor in semantic view\",\n          didDispatch: (event) => {\n            const editor = event.currentTarget.getModel()\n            this.selectAtCursorLine({newBufferPosition: editor.getCursorBufferPosition()})\n          },\n        },\n      }),\n      atom.config.observe(\"atom-typescript-updated.longLineLength\", (value) => {\n        if (value > 0) this.longLineLength = value\n      }),\n      atom.config.observe(\"atom-typescript-updated.largeFileLineCount\", (value) => {\n        if (value > 0) this.largeFileLineCount = value\n      }),\n      atom.config.observe(\"linter-ui-default.longLineLength\", (value) => {\n        if (atom.config.get(\"atom-typescript-updated.longLineLength\") > 0) return\n        if (typeof value === \"number\") this.longLineLength = value\n      }),\n      atom.config.observe(\"linter-ui-default.largeFileLineCount\", (value) => {\n        if (atom.config.get(\"atom-typescript-updated.largeFileLineCount\") > 0) return\n        if (typeof value === \"number\") this.largeFileLineCount = value / 6\n      }),\n    )\n  }\n\n  public async update(props: Partial<Props>) {\n    if (props.navTree !== undefined) {\n      this.setNavTree(props.navTree)\n    }\n    this.props = {...this.props, ...props}\n    await etch.update(this)\n  }\n\n  public async destroy() {\n    if (this.editorScrolling) this.editorScrolling.dispose()\n    if (this.editorChanging) this.editorChanging.dispose()\n    this.editorScrolling = undefined\n    this.editorChanging = undefined\n    this.subscriptions.dispose()\n    await etch.destroy(this)\n  }\n\n  public async setGetClient(getClient: GetClientFunction) {\n    this.getClient = getClient\n    await this.loadNavTree()\n  }\n\n  public getSelectedNode() {\n    return this.element.querySelector<HTMLElement>(\".header.selected\") ?? undefined\n  }\n\n  public clearSelection() {\n    const elems = this.element.querySelectorAll<HTMLElement>(\".header.selected\")\n    for (let i = 0; i < elems.length; i += 1) {\n      elems.item(i).classList.remove(\"selected\")\n    }\n  }\n\n  public markSelection(node?: HTMLLIElement) {\n    this.clearSelection()\n    if (!node) return\n    const h = node.querySelector<HTMLElement>(\".header\")\n    if (h) h.classList.add(\"selected\")\n  }\n\n  public firstNode() {\n    return this.element.querySelector<HTMLLIElement>(\"li.node\") ?? undefined\n  }\n\n  public render() {\n    const maybeNavNodeComp = this.props.navTree ? (\n      <NavigationNodeComponent navTree={this.props.navTree} ctrl={this} />\n    ) : null\n    return (\n      <div className=\"atomts atomts-semantic-view native-key-bindings\">\n        <ol className=\"list-tree has-collapsable-children focusable-panel\">{maybeNavNodeComp}</ol>\n      </div>\n    )\n  }\n\n  public readAfterUpdate() {\n    // scroll to selected node:\n    const selectedElement = this.element.querySelector(\".selected\")\n    if (selectedElement) this.scrollTo(selectedElement)\n  }\n\n  /**\n   * HELPER scroll the current editor so that the node's representation becomes\n   *        visible\n   *        (i.e. scroll the text/typescript editor)\n   * @param  {NavigationTree} node\n   *              the node which's element should be made visible in the editor\n   */\n  public gotoNode(node: NavigationTree): void {\n    if (!this.editor) return\n    const gotoLine = getNodeStartLine(node)\n    const gotoOffset = getNodeStartOffset(node)\n    this.editor.setCursorBufferPosition([gotoLine, gotoOffset])\n  }\n\n  private getCursorLine(): number | undefined {\n    if (this.editor) return this.editor.getLastCursor().getBufferRow()\n    else return undefined\n  }\n\n  private setNavTree(navTree: NavigationTreeViewModel | null) {\n    prepareNavTree(navTree)\n    if (isEqual(navTree, this.props.navTree)) {\n      return\n    }\n    restoreCollapsed(navTree, this.props.navTree)\n    this.props.navTree = navTree\n\n    const node = this.firstNode()\n    if (node) {\n      const cursorLine = this.getCursorLine()\n      if (cursorLine !== undefined) {\n        this.markSelection(findNodeAt(cursorLine, cursorLine, node))\n      }\n    }\n  }\n\n  private loadNavTree = async () => {\n    if (!this.editor) return\n    if (!this.getClient) return\n    const filePath = this.editor.getPath()\n    if (filePath === undefined) return\n    try {\n      const client = await this.getClient(filePath)\n      const navtreeResult = await client.execute(\"navtree\", {file: filePath})\n      const navTree = navtreeResult.body\n      if (navTree) {\n        this.setNavTree(navTree as NavigationTreeViewModel)\n        await etch.update(this)\n      }\n    } catch (err) {\n      console.error(err, filePath)\n    }\n  }\n\n  /**\n   * HELPER select the node's HTML represenation which corresponds to the\n   *        current cursor position\n   */\n  private selectAtCursorLine = ({newBufferPosition}: {newBufferPosition: Point}) => {\n    const firstNodeElem = this.firstNode()\n    if (!firstNodeElem) {\n      return\n    }\n    const cursorLine = newBufferPosition.row\n\n    const selectedChild =\n      findNodeAt(cursorLine, cursorLine, firstNodeElem)?.querySelector(\".header\") ?? undefined\n    const currentSelection = this.getSelectedNode()\n    if (selectedChild !== currentSelection) {\n      if (currentSelection) currentSelection.classList.remove(\"selected\")\n      if (selectedChild) selectedChild.classList.add(\"selected\")\n    }\n  }\n\n  /**\n   * HELPER scroll the node's HTML representation (i.e. domNode) into view\n   *        (i.e. scroll the semantic-view's tree representation)\n   * @param  {Element} domNode the HTMLElement that should be made visisble\n   */\n  private scrollTo(domNode: Element): void {\n    const elem: ElementExp = domNode as ElementExp\n    if (typeof elem.scrollIntoViewIfNeeded === \"function\") {\n      elem.scrollIntoViewIfNeeded()\n    } else {\n      elem.scrollIntoView()\n    }\n  }\n\n  private subscribeToEditor = async (editor?: TextEditor) => {\n    if (this.editorScrolling) this.editorScrolling.dispose()\n    if (this.editorChanging) this.editorChanging.dispose()\n\n    if (!editor || !atomUtils.isTypescriptEditorWithPath(editor)) {\n      return this.update({navTree: null})\n    }\n    // else\n    this.editor = editor\n    // set navTree\n    await this.loadNavTree()\n\n    const lineCount = this.lineCountIfLarge(editor)\n    if (!atom.config.get(\"atom-typescript-updated.largeFileNoFollowCursor\") || lineCount === 0) {\n      this.editorScrolling = editor.onDidChangeCursorPosition(this.selectAtCursorLine)\n    }\n    this.editorChanging = editor.onDidStopChanging(\n      lineCount === 0 ? this.loadNavTree : debounce(this.loadNavTree, Math.max(lineCount / 5, 300)),\n    )\n  }\n\n  private lineCountIfLarge(editor: TextEditor) {\n    const lineCount = editor.getLineCount()\n    if (lineCount >= this.largeFileLineCount) {\n      // large file detection\n      return lineCount\n    } else {\n      // long line detection\n      const buffer = editor.getBuffer()\n      for (let i = 0, len = lineCount; i < len; i++) {\n        if (buffer.lineLengthForRow(i) > this.longLineLength) {\n          return this.longLineLength / 100\n        }\n      }\n      return 0 // small file\n    }\n  }\n}\n","export * from \"./atom\"\nexport * from \"./ts\"\n","import * as Atom from \"atom\"\nimport {memoize, throttle} from \"lodash\"\nimport * as path from \"path\"\nimport {FileLocationQuery, Location, pointToLocation} from \"./ts\"\n\nexport {highlight} from \"./highlighter\"\n\n// Return line/offset position in the editor using 1-indexed coordinates\nfunction getEditorPosition(editor: Atom.TextEditor): Location {\n  const pos = editor.getCursorBufferPosition()\n  return {\n    line: pos.row + 1,\n    offset: pos.column + 1,\n  }\n}\n\nexport function isTypescriptFile(filePath: string | undefined): boolean {\n  if (filePath === undefined) return false\n  return isAllowedExtension(path.extname(filePath))\n}\n\nexport function typeScriptScopes(): ReadonlyArray<string> {\n  const config = atom.config.get(\"atom-typescript-updated\")\n  const tsScopes = [...config.tsSyntaxScopes, ...config.jsSyntaxScopes]\n\n  return tsScopes\n}\n\nexport function isTypescriptEditorWithPath(editor: Atom.TextEditor) {\n  return isTypescriptFile(editor.getPath()) && isTypescriptGrammar(editor)\n}\n\nexport function isTypescriptGrammar(editor: Atom.TextEditor): boolean {\n  const [scopeName] = editor.getRootScopeDescriptor().getScopesArray()\n  return typeScriptScopes().includes(scopeName)\n}\n\nfunction notNullary<T>(x: T | undefined | null): x is T {\n  return x != null\n}\n\nfunction memoizeThrottle<T, U>(func: (arg: T) => U, wait: number): (arg: T) => U {\n  const mem = memoize((_param: T) => throttle(func, wait, {leading: true}))\n  return (param: T) => mem(param)(param)! // NOTE: leading MUST be true for this ! to hold\n}\n\nconst isAllowedExtension = memoizeThrottle((ext: string) => {\n  const config = atom.config.get(\"atom-typescript-updated\")\n  const tsExts = [...config.tsFileExtensions, ...config.jsFileExtensions]\n\n  if (config.extensionsFromGrammars) {\n    const custom = atom.config.get(\"core.customFileTypes\") ?? {}\n    const scopes = typeScriptScopes()\n    tsExts.push(\n      ...([] as Array<string | undefined>)\n        .concat(\n          ...scopes.map((scope) => atom.grammars.grammarForScopeName(scope)?.fileTypes),\n          ...scopes.map((scope) => custom[scope]),\n        )\n        .filter(notNullary)\n        .map((s) => `.${s}`),\n    )\n  }\n  return tsExts.includes(ext)\n}, 5000)\n\nexport function getFilePathPosition(\n  editor: Atom.TextEditor,\n  position?: Atom.Point,\n): FileLocationQuery | undefined {\n  const file = editor.getPath()\n  if (file !== undefined) {\n    const location = position ? pointToLocation(position) : getEditorPosition(editor)\n    return {file, ...location}\n  }\n}\n\nexport function* getOpenEditorsPaths() {\n  for (const ed of atom.workspace.getTextEditors()) {\n    if (isTypescriptEditorWithPath(ed)) yield ed.getPath()!\n  }\n}\n","import * as Atom from \"atom\"\nimport {Signature, SignatureParameter} from \"atom-ide-base\"\nimport * as path from \"path\"\nimport ts from \"typescript\"\nimport type {\n  CodeEdit,\n  FormatCodeSettings,\n  Location,\n  SignatureHelpItem,\n  SignatureHelpParameter,\n  TextSpan,\n  UserPreferences,\n} from \"typescript/lib/protocol\"\n\n// NOTE: using TypeScript internals here. May be brittle!\ndeclare module \"typescript\" {\n  export const Diagnostics: {\n    [key: string]: DiagnosticMessage\n  }\n}\n\nexport {TextSpan, CodeEdit, FormatCodeSettings, Location}\nexport const DiagnosticCategory = ts.DiagnosticCategory\n\nexport interface LocationRangeQuery extends Location {\n  endLine: number\n  endOffset: number\n}\n\nexport interface FileLocationQuery extends Location {\n  file: string\n}\n\nexport function pointToLocation(point: Atom.PointLike): Location {\n  return {line: point.row + 1, offset: point.column + 1}\n}\n\nexport function locationToPoint(loc: Location): Atom.Point {\n  return new Atom.Point(loc.line - 1, loc.offset - 1)\n}\n\nexport function spanToRange(span: TextSpan): Atom.Range {\n  return locationsToRange(span.start, span.end)\n}\n\nexport function locationsToRange(start: Location, end: Location): Atom.Range {\n  return new Atom.Range(locationToPoint(start), locationToPoint(end))\n}\n\nexport function rangeToLocationRange(range: Atom.Range): LocationRangeQuery {\n  return {\n    line: range.start.row + 1,\n    offset: range.start.column + 1,\n    endLine: range.end.row + 1,\n    endOffset: range.end.column + 1,\n  }\n}\n\nexport interface ProjectConfig {\n  formatCodeOptions: FormatCodeSettings\n  compileOnSave: boolean\n  preferences: UserPreferences\n}\n\nexport function getProjectConfig(configFile: string): ProjectConfig {\n  const config = loadConfig(configFile)\n  const options = (config as {formatCodeOptions?: FormatCodeSettings}).formatCodeOptions\n\n  return {\n    formatCodeOptions: {\n      indentSize: atom.config.get(\"editor.tabLength\"),\n      tabSize: atom.config.get(\"editor.tabLength\"),\n      ...options,\n    },\n    compileOnSave: !!config.compileOnSave,\n    preferences: config.preferences ? config.preferences : {},\n  }\n}\n\nfunction loadConfig(configFile: string): Partial<ProjectConfig> {\n  if (path.extname(configFile) !== \".json\") {\n    configFile = `${configFile}.json`\n  }\n  let {\n    config,\n  }: {\n    config?: {[key: string]: unknown}\n  } = ts.readConfigFile(configFile, (file) => ts.sys.readFile(file))\n  if (config === undefined) return {}\n  if (typeof config.extends === \"string\") {\n    const extendsPath = path.join(path.dirname(configFile), config.extends)\n    const extendsConfig = loadConfig(extendsPath)\n    config = Object.assign({}, extendsConfig, config)\n  }\n  return config as ReturnType<typeof loadConfig>\n}\n\nexport function signatureHelpItemToSignature(i: SignatureHelpItem): Signature {\n  return {\n    label:\n      partsToStr(i.prefixDisplayParts) +\n      i.parameters\n        .map((x) => partsToStr(x.displayParts))\n        .join(partsToStr(i.separatorDisplayParts)) +\n      partsToStr(i.suffixDisplayParts),\n    documentation: partsToStr(i.documentation),\n    parameters: i.parameters.map(signatureHelpParameterToSignatureParameter),\n  }\n}\n\nexport function signatureHelpParameterToSignatureParameter(\n  p: SignatureHelpParameter,\n): SignatureParameter {\n  return {\n    label: partsToStr(p.displayParts),\n    documentation: partsToStr(p.documentation),\n  }\n}\n\nexport function partsToStr(x: Array<{text: string}>): string {\n  return x.map((i) => i.text).join(\"\")\n}\n\nexport const checkDiagnosticCategory = (function () {\n  let codeToCategory: Map<number, ts.DiagnosticCategory> | undefined\n  return function (code: number | undefined, category: ts.DiagnosticCategory) {\n    if (code === undefined) return true\n    if (codeToCategory === undefined) {\n      codeToCategory = new Map(Object.values(ts.Diagnostics).map((x) => [x.code, x.category]))\n    }\n    const cat = codeToCategory.get(code)\n    if (cat === undefined) return true\n    return cat === category\n  }\n})()\n","import {TextBuffer} from \"atom\"\nimport type {LanguageMode} from \"./highlighter-types\"\n\nfunction eventLoopYielder(delayMs: number, maxTimeMs: number) {\n  const started = performance.now()\n  let lastYield = started\n  return async function (): Promise<boolean> {\n    const now = performance.now()\n    if (now - lastYield > delayMs) {\n      await new Promise(setImmediate)\n      lastYield = now\n    }\n    return now - started <= maxTimeMs\n  }\n}\n\n/** Throws maximum time reached error */\nfunction maxTimeError(name: string, timeS: number) {\n  const err = new Error(\"Max time reached\")\n  atom.notifications.addError(`${name} took more than ${timeS} seconds to complete`, {\n    dismissable: true,\n    description: `${name} took too long to complete and was terminated.`,\n    stack: err.stack,\n  })\n  return err\n}\n\nexport async function highlight(sourceCode: string, scopeName: string) {\n  const yielder = eventLoopYielder(100, 5000)\n  const buf = new TextBuffer()\n  try {\n    const grammar = atom.grammars.grammarForId(scopeName)\n    const lm = atom.grammars.languageModeForGrammarAndBuffer(grammar, buf)\n    buf.setLanguageMode(lm)\n    buf.setText(sourceCode)\n    const end = buf.getEndPosition()\n    if (lm.startTokenizing) lm.startTokenizing()\n    await tokenized(lm)\n    const iter = lm.buildHighlightIterator()\n    if (iter.getOpenScopeIds && iter.getCloseScopeIds) {\n      let pos = {row: 0, column: 0}\n      iter.seek(pos)\n      const res = []\n      while (pos.row < end.row || (pos.row === end.row && pos.column <= end.column)) {\n        res.push(\n          ...iter.getCloseScopeIds().map(() => \"</span>\"),\n          ...iter.getOpenScopeIds().map((x) => `<span class=\"${lm.classNameForScopeId(x)}\">`),\n        )\n        iter.moveToSuccessor()\n        const nextPos = iter.getPosition()\n        res.push(escapeHTML(buf.getTextInRange([pos, nextPos])))\n\n        if (!(await yielder())) {\n          console.error(maxTimeError(\"Atom-TypeScript: Highlighter\", 5))\n          break\n        }\n        pos = nextPos\n      }\n      return res.join(\"\")\n    } else {\n      return sourceCode\n    }\n  } finally {\n    buf.destroy()\n  }\n}\n\nasync function tokenized(lm: LanguageMode) {\n  return new Promise((resolve) => {\n    if (lm.fullyTokenized || lm.tree) {\n      resolve(undefined)\n    } else if (lm.onDidTokenize) {\n      const disp = lm.onDidTokenize(() => {\n        disp.dispose()\n        resolve(undefined)\n      })\n    } else {\n      resolve(undefined) // null language mode\n    }\n  })\n}\n\nfunction escapeHTML(str: string) {\n  return str\n    .replace(/&/g, \"&amp;\")\n    .replace(/</g, \"&lt;\")\n    .replace(/>/g, \"&gt;\")\n    .replace(/\"/g, \"&quot;\")\n    .replace(/'/g, \"&#039;\")\n}\n","import * as etch from \"etch\"\nimport {handlePromise} from \"../../../../utils\"\nimport {isToggleEntry} from \"./navTreeUtils\"\nimport {NavigationTreeViewModel, SelectableNode, ToNodeScrollableEditor} from \"./semanticViewModel\"\n\nexport interface Props extends JSX.Props {\n  navTree: NavigationTreeViewModel\n  ctrl: ToNodeScrollableEditor & SelectableNode\n}\n\nexport class NavigationNodeComponent implements JSX.ElementClass {\n  constructor(public props: Props) {\n    etch.initialize(this)\n  }\n\n  public async update(props: Partial<Props>) {\n    this.props = {...this.props, ...props}\n    await etch.update(this)\n  }\n\n  public async destroy() {\n    await etch.destroy(this)\n  }\n\n  public render(): JSX.Element {\n    const node = this.props.navTree\n    const {ctrl} = this.props\n    const classes =\n      (node.childItems ? \"nested-\" : \"\") + \"item\" + (node.collapsed ? \" collapsed\" : \" expanded\")\n    const styleClasses = this.getStyles()\n\n    return (\n      <li\n        className={\"node entry exanded list-\" + classes}\n        dataset={{\n          startLine: this.props.navTree.spans[0]?.start?.line,\n          endLine: this.props.navTree.spans[0]?.end?.line,\n        }}>\n        <div className={`header list-item`} on={{click: (event) => this.entryClicked(event, node)}}>\n          <span className={styleClasses}>{node.text}</span>\n        </div>\n        <ol className=\"entries list-tree\">\n          {node.childItems\n            ? node.childItems.map((sn, i) => <NavigationNodeComponent key={i} navTree={sn} ctrl={ctrl} />)\n            : null}\n        </ol>\n      </li>\n    )\n  }\n\n  private getStyles(): string {\n    const {kind} = this.props.navTree\n    let styles = `icon icon-${kind}`\n    const {kindModifiers} = this.props.navTree\n    if (kindModifiers) {\n      styles +=\n        \" \" +\n        kindModifiers\n          .split(/[, ]/)\n          .map((modifier) => `modifier-${modifier.trim()}`)\n          .join(\" \")\n    }\n    return styles\n  }\n\n  private entryClicked(event: MouseEvent, node: NavigationTreeViewModel): void {\n    event.stopPropagation()\n\n    const isToggle: boolean = isToggleEntry(node, event)\n    if (!isToggle) {\n      this.props.ctrl.gotoNode(node)\n    } else {\n      node.collapsed = !node.collapsed\n      handlePromise(etch.update(this))\n    }\n  }\n}\n","import {isEqual} from \"lodash\"\nimport {NavigationTree} from \"typescript/lib/protocol\"\nimport {NavigationTreeViewModel} from \"./semanticViewModel\"\n\nfunction getElStartLine(elem: HTMLElement): number {\n  const v = elem.dataset[\"startLine\"]\n  return v !== undefined ? parseInt(v, 10) - 1 : 0\n}\n\nfunction getElEndLine(elem: HTMLElement): number {\n  const v = elem.dataset[\"endLine\"]\n  return v !== undefined ? parseInt(v, 10) - 1 : 0\n}\n\n/**\n * HELPER find the node that is \"furthest down\" the\n *        node hiearchy, i.e. which's start-, end-position contains the\n *        cursorLine AND is smallest.\n * @param  {NavigationTreeViewModel} node\n *                  the HTML element from which to start searching\n * @param  {Number} cursorLine the cursor line\n * @return {HTMLElement|null} the node's HTML representation which matches cursorLine\n *                            (i.e. which' start-, end-position contain cursorLine while\n *                             having the smallest distance to cursorLine), or NULL if no\n *                            matching node can be found\n */\nexport function findNodeAt(\n  startLine: number,\n  endLine: number,\n  node: HTMLLIElement,\n): HTMLLIElement | undefined {\n  const children = node.querySelectorAll<HTMLLIElement>(\":scope > ol > li.node\")\n  if (children.length === 0) {\n    return undefined\n  }\n\n  for (const elem of Array.from(children)) {\n    const start: number = getElStartLine(elem)\n    const end: number = getElEndLine(elem)\n    if (isFinite(start) && isFinite(end)) {\n      if (startLine >= start && endLine <= end) {\n        const selected = findNodeAt(startLine, endLine, elem)\n        if (selected) {\n          return selected\n        } else {\n          return elem\n        }\n      } else if (isFinite(end) && endLine < end) {\n        break\n      }\n    }\n\n    const selectedChild = findNodeAt(startLine, endLine, elem)\n\n    if (selectedChild) {\n      return selectedChild\n    }\n  }\n\n  const nstart: number = getElStartLine(node)\n  const nend: number = getElEndLine(node)\n  if (isFinite(nstart) && isFinite(nend) && startLine >= nstart && endLine <= nend) {\n    return node\n  }\n  return undefined\n}\n\n/**\n * Get start line for NavTree node\n * @param  node the NavTre node\n * @return the start line for the NavTree node, or 0, if none could be determined\n */\nexport function getNodeStartLine(node: NavigationTree): number {\n  return node.spans.length > 0 ? node.spans[0].start.line - 1 : 0\n}\n\n/**\n * Get start column for NavTree node\n * @param  node the NavTre node\n * @return the start column for the NavTree node, or 0, if none could be determined\n */\nexport function getNodeStartOffset(node: NavigationTree): number {\n  return node.spans.length > 0 ? node.spans[0].start.offset - 1 : 0\n}\n\n/**\n * Get end line for NavTree node\n * @param  node the NavTre node\n * @return the end line for the NavTree node, or 0, if none could be determined\n */\nexport function getNodeEndLine(node: NavigationTree): number {\n  const s = node.spans\n  return s.length > 0 ? s[s.length - 1].end.line - 1 : 0\n}\n\n/**\n * HELPER transfere collapsed state from old NavigationTreeViewModel to\n * new view model.\n *\n * @returns {boolean} TRUE, if newTree and oldTree matched title\n */\nexport function restoreCollapsed(\n  newTree: NavigationTreeViewModel | null,\n  oldTree: NavigationTreeViewModel | null,\n): boolean {\n  if (!newTree || !oldTree) return newTree === oldTree\n\n  // a bit of guess work here:\n  // there may have been additions/deletions in the children\n  // (in comparision to the previous navTree), so the tranfere of\n  // the collapsed state really is a heuristical process.\n  //\n  // For now, we assume, if the name (i.e. node.text) is the same\n  // then it refers to the same entity (i.e. it should get the same\n  // collapsed state); which is not true in case a variable/function/etc\n  // was renamed.\n  // But we do not want the get too elaborate and do expensive modification-\n  // detection here, so in case of renaming, we just reset the collapsed\n  // state to the default (i.e. expanded).\n  // Same for reordering etc. of children: for complex changes we just\n  // revert to the default state.\n\n  if (newTree.text === oldTree.text) {\n    if (oldTree.collapsed) {\n      newTree.collapsed = true\n    }\n\n    if (newTree.childItems && oldTree.childItems) {\n      let newChild: NavigationTreeViewModel\n      let oldChild: NavigationTreeViewModel\n      for (let i = 0, size = newTree.childItems.length; i < size; ++i) {\n        newChild = newTree.childItems[i]\n        oldChild = oldTree.childItems[i]\n        // allow for one addition / deletion in the children\n        // (i.e. check if there's a match in the previous/next position)\n        if (!restoreCollapsed(newChild, oldChild)) {\n          // try, if a child was removed\n          oldChild = oldTree.childItems[i + 1]\n          if (!restoreCollapsed(newChild, oldChild)) {\n            // try, if a child was added\n            oldChild = oldTree.childItems[i - 1]\n            restoreCollapsed(newChild, oldChild)\n          }\n        }\n      }\n    }\n    return true\n  }\n\n  return false\n}\n\n/**\n * HELPER modify / prepare NavigationTree for rendering.\n *\n * E.g. sort childItems by their location, preprocess className-string\n *\n * @param {NavigationTreeViewModel} navTree\n *            the NavigationTree that will be prepared for rendering\n */\nexport function prepareNavTree(navTree: NavigationTreeViewModel | null): void {\n  if (navTree === null) return\n\n  if (navTree.childItems) {\n    if (navTree.childItems.length < 1) {\n      // normalize: remove empty lists\n      navTree.childItems = undefined\n      return\n    }\n\n    // TODO should there be a different sort-order?\n    //     for now: sort ascending by line-number\n    navTree.childItems.sort((a, b) => getNodeStartLine(a) - getNodeStartLine(b))\n\n    for (const child of navTree.childItems) {\n      prepareNavTree(child)\n    }\n  }\n}\n\n/**\n * HELPER test, if the HTMLElement for <code>node</code> should be displayed\n *        as \"selected\", by checking if the current cursor is within\n *        start-, end-line of the node.\n *\n * NOTE since a potential to-be-selected node may conatain other nodes,\n *      that also \"should be selected\", this functions checks, if there is a\n *      node \"furthest down\" in the hiearchy that could/should get selected.\n *\n * @param  {NavigationTreeViewModel} node\n *            the node to be tested\n * @param  {number} pos\n *            the cursor (line) position in the editor\n * @return {Boolean} true, if the node's HTML representation should be selected\n */\nexport function isSelected(node: HTMLLIElement, pos: number): boolean {\n  const start: number = getElStartLine(node)\n  const end: number = getElEndLine(node)\n  if (start <= pos && end >= pos) {\n    if (findNodeAt(start, end, node)) {\n      // -> there is a node \"further down\" that should get selected\n      return false\n    }\n    return true\n  }\n  return false\n}\n\n/**\n * compare nodes base on their label & code-position\n * (i.e. ignoring modifiers, children etc)\n */\nexport function isSameNode(n1: NavigationTreeViewModel, n2: NavigationTreeViewModel): boolean {\n  return n1.text === n2.text && isEqual(n1.spans, n2.spans)\n}\n\n/**\n * HACK workaround for detecting click on collapse-/expand-icon\n *      (cannot directly register/detect click on icons, since inserted via ::before style)\n *\n * @param {NavigationTreeViewModel} node\n *                        the corresponding NavTree node\n * @param {MouseEvent} event\n *                        the mouse event\n * @returns {Boolean} <code>true</code> if entry's expand/collapse state should be toggled for nodeEntry\n *                                      (instead of navigating to its position in the text editor)\n */\nexport function isToggleEntry(node: NavigationTreeViewModel, event: MouseEvent): boolean {\n  return !!node.childItems && event.target === event.currentTarget\n}\n","import * as Atom from \"atom\"\nimport {CompositeDisposable} from \"atom\"\nimport {BusySignalService, DatatipService, SignatureHelpRegistry} from \"atom-ide-base\"\nimport {IndieDelegate} from \"atom/linter\"\nimport {StatusBar} from \"atom/status-bar\"\nimport {throttle} from \"lodash\"\nimport * as path from \"path\"\nimport {ClientResolver} from \"../client\"\nimport {handlePromise} from \"../utils\"\nimport {getCodeActionsProvider} from \"./atom-ide/codeActionsProvider\"\nimport {getCodeHighlightProvider} from \"./atom-ide/codeHighlightProvider\"\nimport {TSDatatipProvider} from \"./atom-ide/datatipProvider\"\nimport {getDefinitionProvider} from \"./atom-ide/definitionsProvider\"\nimport {getFindReferencesProvider} from \"./atom-ide/findReferencesProvider\"\nimport {getHyperclickProvider} from \"./atom-ide/hyperclickProvider\"\nimport {getOutlineProvider} from \"./atom-ide/outlineProvider\"\nimport {TSSigHelpProvider} from \"./atom-ide/sigHelpProvider\"\nimport {AutocompleteProvider} from \"./atom/autoCompleteProvider\"\nimport {CodefixProvider} from \"./atom/codefix\"\nimport {\n  getIntentionsHighlightsProvider,\n  getIntentionsProvider,\n} from \"./atom/codefix/intentionsProvider\"\nimport {registerCommands} from \"./atom/commands\"\nimport {StatusPanel, TBuildStatus, TProgress} from \"./atom/components/statusPanel\"\nimport {EditorPositionHistoryManager} from \"./atom/editorPositionHistoryManager\"\nimport {isTypescriptEditorWithPath, spanToRange, TextSpan} from \"./atom/utils\"\nimport {SemanticViewController} from \"./atom/views/outline/semanticViewController\"\nimport {SymbolsViewController} from \"./atom/views/symbols/symbolsViewController\"\nimport {ErrorPusher} from \"./errorPusher\"\nimport {State} from \"./packageState\"\nimport {TypescriptEditorPane} from \"./typescriptEditorPane\"\n\nexport interface Change extends TextSpan {\n  newText: string\n}\nexport interface Edit {\n  fileName: string\n  textChanges: ReadonlyArray<Readonly<Change>>\n}\nexport type Edits = ReadonlyArray<Readonly<Edit>>\nexport type ApplyEdits = (edits: Edits) => Promise<void>\nexport type ReportBusyWhile = <T>(title: string, generator: () => Promise<T>) => Promise<T>\n\nexport class PluginManager {\n  // components\n  private subscriptions: CompositeDisposable\n  private clientResolver: ClientResolver\n  private statusPanel: StatusPanel\n  private errorPusher: ErrorPusher\n  private codefixProvider: CodefixProvider\n  private semanticViewController: SemanticViewController\n  private symbolsViewController: SymbolsViewController\n  private editorPosHist: EditorPositionHistoryManager\n  private pending = new Set<{title: string}>()\n  private busySignalService?: BusySignalService\n  private typescriptPaneFactory: (editor: Atom.TextEditor) => TypescriptEditorPane\n\n  public constructor(state?: Partial<State>) {\n    this.subscriptions = new CompositeDisposable()\n\n    this.clientResolver = new ClientResolver(this.reportBusyWhile)\n    this.subscriptions.add(this.clientResolver)\n\n    this.statusPanel = new StatusPanel()\n    this.subscriptions.add(this.statusPanel)\n\n    this.errorPusher = new ErrorPusher()\n    this.subscriptions.add(this.errorPusher)\n\n    this.codefixProvider = new CodefixProvider(\n      this.clientResolver,\n      this.errorPusher,\n      this.applyEdits,\n    )\n    this.subscriptions.add(this.codefixProvider)\n\n    this.semanticViewController = new SemanticViewController(this.getClient)\n    this.subscriptions.add(this.semanticViewController)\n\n    this.editorPosHist = new EditorPositionHistoryManager(state && state.editorPosHistState)\n    this.subscriptions.add(this.editorPosHist)\n\n    this.symbolsViewController = new SymbolsViewController({\n      histGoForward: this.histGoForward,\n      getClient: this.getClient,\n    })\n    this.subscriptions.add(this.symbolsViewController)\n\n    this.typescriptPaneFactory = TypescriptEditorPane.createFactory({\n      clearFileErrors: this.clearFileErrors,\n      getClient: this.getClient,\n      reportBuildStatus: this.reportBuildStatus,\n      reportClientInfo: this.reportClientInfo,\n    })\n    this.subscribeEditors()\n\n    // Register the commands\n    this.subscriptions.add(\n      registerCommands({\n        getClient: this.getClient,\n        applyEdits: this.applyEdits,\n        clearErrors: this.clearErrors,\n        killAllServers: this.killAllServers,\n        reportProgress: this.reportProgress,\n        reportBuildStatus: this.reportBuildStatus,\n        toggleSemanticViewController: () => {\n          handlePromise(this.semanticViewController.toggle())\n        },\n        toggleFileSymbolsView: (ed) => {\n          this.symbolsViewController.toggleFileView(ed)\n        },\n        toggleProjectSymbolsView: (ed) => {\n          this.symbolsViewController.toggleProjectView(ed)\n        },\n        histGoForward: this.histGoForward,\n        histGoBack: () => this.editorPosHist.goBack(),\n        histShowHistory: () => this.editorPosHist.showHistory(),\n        showTooltipAt: this.showTooltipAt,\n        showSigHelpAt: this.showSigHelpAt,\n        hideSigHelpAt: this.hideSigHelpAt,\n        rotateSigHelp: this.rotateSigHelp,\n      }),\n    )\n  }\n\n  public destroy() {\n    this.subscriptions.dispose()\n    for (const ed of atom.workspace.getTextEditors()) {\n      const pane = TypescriptEditorPane.lookupPane(ed)\n      if (pane) pane.destroy()\n    }\n    this.clientResolver.dispose()\n  }\n\n  public serialize(): State {\n    return {\n      version: \"0.1\",\n      editorPosHistState: this.editorPosHist.serialize(),\n    }\n  }\n\n  public consumeLinter(register: (opts: {name: string}) => IndieDelegate) {\n    const linter = register({\n      name: \"TypeScript\",\n    })\n\n    this.errorPusher.setLinter(linter)\n\n    this.subscriptions.add(\n      this.clientResolver.on(\"diagnostics\", ({type, filePath, diagnostics}) => {\n        this.errorPusher.setErrors(type, filePath, diagnostics)\n      }),\n    )\n  }\n\n  public consumeStatusBar(statusBar: StatusBar) {\n    let statusPriority = 100\n    for (const panel of statusBar.getRightTiles()) {\n      if (atom.views.getView(panel.getItem()).tagName === \"GRAMMAR-SELECTOR-STATUS\") {\n        statusPriority = panel.getPriority() - 1\n      }\n    }\n    const tile = statusBar.addRightTile({\n      item: this.statusPanel,\n      priority: statusPriority,\n    })\n    const disp = new Atom.Disposable(() => {\n      tile.destroy()\n    })\n    this.subscriptions.add(disp)\n    return disp\n  }\n\n  public consumeDatatipService(datatip: DatatipService) {\n    const disp = datatip.addProvider(new TSDatatipProvider(this.getClient))\n    this.subscriptions.add(disp)\n    return disp\n  }\n\n  public consumeSigHelpService(registry: SignatureHelpRegistry): void | Atom.DisposableLike {\n    const provider = new TSSigHelpProvider(this.getClient)\n    const disp = registry(provider)\n    this.subscriptions.add(disp, provider)\n    return disp\n  }\n\n  public consumeBusySignal(busySignalService: BusySignalService): void | Atom.DisposableLike {\n    this.busySignalService = busySignalService\n    const disp = {\n      dispose: () => {\n        if (this.busySignalService) this.busySignalService.dispose()\n        this.busySignalService = undefined\n      },\n    }\n    this.subscriptions.add(disp)\n    return disp\n  }\n\n  // Registering an autocomplete provider\n  public provideAutocomplete() {\n    return [new AutocompleteProvider(this.getClient, this.applyEdits)]\n  }\n\n  public provideIntentions() {\n    return getIntentionsProvider(this.codefixProvider)\n  }\n\n  public provideIntentionsHighlight() {\n    return getIntentionsHighlightsProvider(this.codefixProvider)\n  }\n\n  public provideCodeActions() {\n    return getCodeActionsProvider(this.codefixProvider)\n  }\n\n  public provideHyperclick() {\n    return getHyperclickProvider(this.getClient, this.histGoForward)\n  }\n\n  public provideReferences() {\n    return getFindReferencesProvider(this.getClient)\n  }\n\n  public provideOutlines() {\n    return getOutlineProvider(this.getClient)\n  }\n\n  public provideDefinitions() {\n    if (atom.config.get(\"atom-typescript-updated\").disableAtomIdeDefinitions) return\n    return getDefinitionProvider(this.getClient)\n  }\n\n  public provideCodeHighlight() {\n    return getCodeHighlightProvider(this.getClient)\n  }\n\n  private clearErrors = () => {\n    this.errorPusher.clear()\n  }\n\n  private clearFileErrors = (filePath: string) => {\n    this.errorPusher.clearFileErrors(filePath)\n  }\n\n  private getClient = async (filePath: string) => {\n    return this.clientResolver.get(filePath)\n  }\n\n  private killAllServers = () => {\n    handlePromise(this.clientResolver.restartAllServers())\n  }\n\n  private withBuffer = async <T>(\n    filePath: string,\n    action: (buffer: Atom.TextBuffer) => Promise<T>,\n  ) => {\n    const normalizedFilePath = path.normalize(filePath)\n    const ed = atom.workspace.getTextEditors().find((p) => p.getPath() === normalizedFilePath)\n\n    // found open buffer\n    if (ed) return action(ed.getBuffer())\n\n    // no open buffer\n    const buffer = await Atom.TextBuffer.load(normalizedFilePath)\n    try {\n      return await action(buffer)\n    } finally {\n      if (buffer.isModified()) await buffer.save()\n      buffer.destroy()\n    }\n  }\n\n  private reportBusyWhile: ReportBusyWhile = async (title, generator) => {\n    if (this.busySignalService) {\n      return this.busySignalService.reportBusyWhile(title, generator)\n    } else {\n      const event = {title}\n      try {\n        this.pending.add(event)\n        this.drawPending(Array.from(this.pending))\n        return await generator()\n      } finally {\n        this.pending.delete(event)\n        this.drawPending(Array.from(this.pending))\n      }\n    }\n  }\n\n  private reportProgress = (progress: TProgress) => {\n    handlePromise(this.statusPanel.update({progress}))\n  }\n\n  private reportBuildStatus = (buildStatus: TBuildStatus | undefined) => {\n    handlePromise(this.statusPanel.update({buildStatus}))\n  }\n\n  private reportClientInfo = (info: {clientVersion: string; tsConfigPath: string | undefined}) => {\n    handlePromise(this.statusPanel.update(info))\n  }\n\n  private applyEdits: ApplyEdits = async (edits) =>\n    void Promise.all(\n      edits.map((edit) =>\n        this.withBuffer(edit.fileName, async (buffer) => {\n          buffer.transact(() => {\n            const changes = edit.textChanges\n              .map((e) => ({range: spanToRange(e), newText: e.newText}))\n              .reverse() // NOTE: needs reverse for cases where ranges are same for two changes\n              .sort((a, b) => b.range.compare(a.range))\n            for (const change of changes) {\n              buffer.setTextInRange(change.range, change.newText)\n            }\n          })\n        }),\n      ),\n    )\n\n  private showTooltipAt = async (ed: Atom.TextEditor): Promise<void> => {\n    await atom.commands.dispatch(atom.views.getView(ed), \"datatip:toggle\")\n  }\n\n  private showSigHelpAt = async (ed: Atom.TextEditor): Promise<void> => {\n    await atom.commands.dispatch(atom.views.getView(ed), \"signature-help:show\")\n  }\n\n  private hideSigHelpAt = (_: Atom.TextEditor): boolean => {\n    return false\n  }\n\n  private rotateSigHelp = (_: Atom.TextEditor, __: number): boolean => {\n    return false\n  }\n\n  private histGoForward: EditorPositionHistoryManager[\"goForward\"] = (ed, opts) => {\n    return this.editorPosHist.goForward(ed, opts)\n  }\n\n  private subscribeEditors() {\n    this.subscriptions.add(\n      atom.workspace.observeTextEditors((editor: Atom.TextEditor) => {\n        this.typescriptPaneFactory(editor)\n      }),\n      atom.workspace.onDidChangeActiveTextEditor((ed) => {\n        if (ed && isTypescriptEditorWithPath(ed)) {\n          handlePromise(this.statusPanel.show())\n          const tep = TypescriptEditorPane.lookupPane(ed)\n          if (tep) tep.didActivate()\n        } else handlePromise(this.statusPanel.hide())\n      }),\n    )\n  }\n\n  private drawPending = throttle(\n    (pending: Array<{title: string}>) => handlePromise(this.statusPanel.update({pending})),\n    100,\n    {leading: false},\n  )\n}\n","export {ClientResolver} from \"./clientResolver\"\nexport {resolveBinary} from \"./resolveBinary\"\n\nimport {TypescriptServiceClient} from \"./client\"\n\nexport {TypescriptServiceClient as TSClient}\n\nexport type GetClientFunction = (filePath: string) => Promise<TypescriptServiceClient>\n","import {CompositeDisposable, Emitter} from \"atom\"\nimport ts from \"typescript\"\nimport {\n  ConfigFileDiagnosticEventBody,\n  Diagnostic,\n  DiagnosticEventBody,\n} from \"typescript/lib/protocol\"\nimport {ReportBusyWhile} from \"../main/pluginManager\"\nimport {handlePromise} from \"../utils\"\nimport {TypescriptServiceClient as Client} from \"./client\"\nimport {resolveBinary} from \"./resolveBinary\"\n\nexport type DiagnosticTypes = protocol.DiagnosticEventKind | \"configFileDiag\"\n\ninterface DiagnosticsPayload {\n  diagnostics: Diagnostic[]\n  filePath: string\n  serverPath: string\n  type: DiagnosticTypes\n}\n\nexport interface EventTypes {\n  diagnostics: DiagnosticsPayload\n}\n\n/**\n * ClientResolver takes care of finding the correct tsserver for a source file based on how a\n * require(\"typescript\") from the same source file would resolve.\n */\nexport class ClientResolver {\n  private clients = new Map<string, Map<string | undefined, Client>>()\n  private memoizedClients = new Map<string, Promise<Client>>()\n  private emitter = new Emitter<{}, EventTypes>()\n  private subscriptions = new CompositeDisposable()\n  private tsserverInstancePerTsconfig =\n    atom.config.get(\"atom-typescript-updated\").tsserverInstancePerTsconfig\n  // This is just here so TypeScript can infer the types of the callbacks when using \"on\" method\n  public on = this.emitter.on.bind(this.emitter)\n\n  constructor(private reportBusyWhile: ReportBusyWhile) {}\n\n  public async restartAllServers() {\n    await this.reportBusyWhile(\"Restarting servers\", () =>\n      Promise.all(Array.from(this.getAllClients()).map((client) => client.restartServer())),\n    )\n  }\n\n  public async get(pFilePath: string): Promise<Client> {\n    const memo = this.memoizedClients.get(pFilePath)\n    if (memo) return memo\n    const client = this._get(pFilePath)\n    this.memoizedClients.set(pFilePath, client)\n    try {\n      return await client\n    } catch (e) {\n      this.memoizedClients.delete(pFilePath)\n      throw e\n    }\n  }\n\n  public dispose() {\n    this.emitter.dispose()\n    this.subscriptions.dispose()\n    this.memoizedClients.clear()\n    for (const tsconfigMap of this.clients.values()) {\n      for (const client of tsconfigMap.values()) {\n        handlePromise(client.destroy())\n      }\n    }\n    this.clients.clear()\n  }\n\n  private async _get(pFilePath: string): Promise<Client> {\n    const {pathToBin, version} = await resolveBinary(pFilePath, \"tsserver\")\n    const tsconfigPath = this.tsserverInstancePerTsconfig\n      ? ts.findConfigFile(pFilePath, (f) => ts.sys.fileExists(f))\n      : undefined\n\n    let tsconfigMap = this.clients.get(pathToBin)\n    if (!tsconfigMap) {\n      tsconfigMap = new Map()\n      this.clients.set(pathToBin, tsconfigMap)\n    }\n    const client = tsconfigMap.get(tsconfigPath)\n    if (client) return client\n\n    const newClient = new Client(pathToBin, version, this.reportBusyWhile)\n    tsconfigMap.set(tsconfigPath, newClient)\n\n    this.subscriptions.add(\n      newClient.on(\"configFileDiag\", this.diagnosticHandler(pathToBin, \"configFileDiag\")),\n      newClient.on(\"semanticDiag\", this.diagnosticHandler(pathToBin, \"semanticDiag\")),\n      newClient.on(\"syntaxDiag\", this.diagnosticHandler(pathToBin, \"syntaxDiag\")),\n      newClient.on(\"suggestionDiag\", this.diagnosticHandler(pathToBin, \"suggestionDiag\")),\n    )\n\n    return newClient\n  }\n\n  private *getAllClients() {\n    for (const tsconfigMap of this.clients.values()) {\n      yield* tsconfigMap.values()\n    }\n  }\n\n  private diagnosticHandler =\n    (serverPath: string, type: DiagnosticTypes) =>\n    (result: DiagnosticEventBody | ConfigFileDiagnosticEventBody) => {\n      const filePath = isConfDiagBody(result) ? result.configFile : result.file\n\n      if (filePath) {\n        this.emitter.emit(\"diagnostics\", {\n          type,\n          serverPath,\n          filePath,\n          diagnostics: result.diagnostics,\n        })\n      }\n    }\n}\n\nfunction isConfDiagBody(body: any): body is ConfigFileDiagnosticEventBody {\n  return body && body.triggerFile && body.configFile\n}\n","import {BufferedNodeProcess, BufferedProcess, Emitter} from \"atom\"\nimport byline from \"byline\"\nimport {ChildProcess} from \"child_process\"\nimport {Readable, Transform} from \"stream\"\nimport protocol from \"typescript/lib/protocol\"\nimport {ReportBusyWhile} from \"../main/pluginManager\"\nimport {Callbacks} from \"./callbacks\"\nimport {\n  AllTSClientCommands,\n  CommandArg,\n  CommandRes,\n  CommandsWithMultistep,\n  CommandsWithResponse,\n} from \"./commandArgsResponseMap\"\nimport {DiagnosticEventTypes} from \"./events\"\n\n// Set this to true to start tsserver with node --inspect\nconst INSPECT_TSSERVER = false\n\nconst commandWithResponseMap: {readonly [K in CommandsWithResponse]: true} = {\n  compileOnSaveAffectedFileList: true,\n  compileOnSaveEmitFile: true,\n  completionEntryDetails: true,\n  completions: true,\n  completionInfo: true,\n  configure: true,\n  definition: true,\n  format: true,\n  getCodeFixes: true,\n  getSupportedCodeFixes: true,\n  documentHighlights: true,\n  projectInfo: true,\n  quickinfo: true,\n  references: true,\n  reload: true,\n  rename: true,\n  navtree: true,\n  navto: true,\n  getApplicableRefactors: true,\n  getEditsForRefactor: true,\n  organizeImports: true,\n  signatureHelp: true,\n  getEditsForFileRename: true,\n  applyCodeActionCommand: true,\n}\n\nconst commandsWithMultistepMap: {readonly [K in CommandsWithMultistep]: true} = {\n  geterr: true,\n  geterrForProject: true,\n}\n\nconst eventTypesMap: {readonly [K in keyof DiagnosticEventTypes]: true} = {\n  configFileDiag: true,\n  semanticDiag: true,\n  suggestionDiag: true,\n  syntaxDiag: true,\n}\n\nconst commandWithResponse = new Set<string>(Object.keys(commandWithResponseMap))\nconst commandWithMultistep = new Set<string>(Object.keys(commandsWithMultistepMap))\nconst eventTypes = new Set<string>(Object.keys(eventTypesMap))\n\nfunction isCommandWithResponse(command: AllTSClientCommands): command is CommandsWithResponse {\n  return commandWithResponse.has(command)\n}\n\nfunction isCommandWithMultistep(command: AllTSClientCommands): command is CommandsWithMultistep {\n  return commandWithMultistep.has(command)\n}\n\nfunction isKnownDiagEventType(event: string): event is keyof DiagnosticEventTypes {\n  return eventTypes.has(event)\n}\n\nexport class TypescriptServiceClient {\n  public readonly multistepSupported: boolean\n  /** Callbacks that are waiting for responses */\n  private readonly callbacks: Callbacks\n\n  private readonly emitter = new Emitter<\n    {\n      restarted: void\n      terminated: void\n    },\n    DiagnosticEventTypes\n  >()\n  private seq = 0\n\n  private server?: ChildProcess\n  private lastStderrOutput = \"\"\n\n  public on = this.emitter.on.bind(this.emitter)\n\n  constructor(\n    public tsServerPath: string,\n    public version: string,\n    private reportBusyWhile: ReportBusyWhile,\n  ) {\n    // multistep completion event is supported as of TS version 2.2\n    const [major, minor] = version\n      .split(\".\")\n      .slice(0, 2)\n      .map((x) => parseInt(x, 10))\n    this.multistepSupported = major > 2 || (major === 2 && minor >= 2)\n\n    this.callbacks = new Callbacks(this.reportBusyWhile)\n    this.server = this.startServer()\n  }\n\n  public async execute<T extends AllTSClientCommands>(\n    command: T,\n    ...args: CommandArg<T>\n  ): Promise<CommandRes<T>> {\n    if (!this.server) {\n      this.server = this.startServer()\n      this.emitter.emit(\"restarted\")\n    }\n\n    const req = {\n      seq: this.seq++,\n      command,\n      arguments: args[0],\n    }\n\n    if (window.atom_typescript_debug) {\n      console.log(\"sending request\", req)\n    }\n\n    let result: CommandRes<T> | Promise<CommandRes<T>> = undefined as CommandRes<T>\n    if (\n      isCommandWithResponse(command) ||\n      (this.multistepSupported && isCommandWithMultistep(command))\n    ) {\n      result = this.callbacks.add(req.seq, command)\n    }\n\n    try {\n      if (!this.server.stdin) throw new Error(\"Server stdin is missing\")\n      this.server.stdin.write(JSON.stringify(req) + \"\\n\")\n    } catch (error) {\n      this.callbacks.error(req.seq, error as Error)\n    }\n    return result\n  }\n\n  public async restartServer() {\n    await this.stopServer()\n    // can't guarantee this.server value after await\n    if (!this.server) {\n      this.server = this.startServer()\n      this.emitter.emit(\"restarted\")\n    }\n  }\n\n  public async destroy() {\n    const terminated = new Promise<void>((resolve) => {\n      const disp = this.emitter.once(\"terminated\", () => {\n        this.emitter.dispose()\n        disp.dispose()\n        resolve()\n      })\n    })\n    return Promise.all([terminated, this.stopServer()])\n  }\n\n  private async stopServer() {\n    if (this.server) {\n      const server = this.server\n      const graceTimer = setTimeout(() => server.kill(), 10000)\n      await Promise.all([\n        this.execute(\"exit\"),\n        new Promise<void>((resolve) => {\n          const disp = this.emitter.once(\"terminated\", () => {\n            disp.dispose()\n            resolve()\n          })\n        }),\n      ])\n      clearTimeout(graceTimer)\n    }\n  }\n\n  private startServer() {\n    if (window.atom_typescript_debug) {\n      console.log(\"starting\", this.tsServerPath)\n    }\n\n    const cp = startServer(this.tsServerPath)\n\n    if (!cp) throw new Error(\"ChildProcess failed to start\")\n\n    const h = this.exitHandler\n    cp.once(\"error\", h)\n    cp.once(\"exit\", (code: number | null, signal: string | null) => {\n      if (code === 0) h(new Error(\"Server stopped normally\"), false)\n      else if (code !== null) h(new Error(`exited with code: ${code}`))\n      else if (signal !== null) h(new Error(`terminated on signal: ${signal}`))\n    })\n\n    // Pipe both stdout and stderr appropriately\n    if (!cp.stdout) throw new Error(\"ChildProcess stdout missing\")\n    if (!cp.stderr) throw new Error(\"ChildProcess stderr missing\")\n    messageStream(cp.stdout).on(\"data\", this.onMessage)\n    cp.stderr.on(\"data\", (data: Buffer) => {\n      console.warn(\"tsserver stderr:\", (this.lastStderrOutput = data.toString()))\n    })\n    return cp\n  }\n\n  private exitHandler = (err: Error, report = true) => {\n    this.callbacks.rejectAll(err)\n    if (report) console.error(\"tsserver: \", err)\n    this.server = undefined\n    this.emitter.emit(\"terminated\")\n\n    if (report) {\n      let detail = err.message\n      if (this.lastStderrOutput) {\n        detail = `Last output from tsserver:\\n${this.lastStderrOutput}\\n\\n${detail}`\n      }\n      atom.notifications.addError(\"TypeScript server quit unexpectedly\", {\n        detail,\n        stack: err.stack,\n        dismissable: true,\n      })\n    }\n  }\n\n  private onMessage = (res: protocol.Response | protocol.Event) => {\n    if (res.type === \"response\") this.callbacks.resolve(res)\n    else this.onEvent(res)\n  }\n\n  private onEvent(res: protocol.Event) {\n    if (window.atom_typescript_debug) {\n      console.log(\"received event\", res)\n    }\n\n    if (res.body) {\n      if (isKnownDiagEventType(res.event)) {\n        this.emitter.emit(res.event, res.body as DiagnosticEventTypes[keyof DiagnosticEventTypes])\n      } else if (res.event === \"requestCompleted\") {\n        this.callbacks.resolveMS(res.body as protocol.RequestCompletedEventBody)\n      }\n    }\n  }\n}\n\nfunction startServer(tsServerPath: string): ChildProcess | undefined {\n  const locale = atom.config.get(\"atom-typescript-updated\").locale\n  const tsServerArgs: string[] = locale ? [\"--locale\", locale] : []\n  if (INSPECT_TSSERVER) {\n    return new BufferedProcess({\n      command: \"node\",\n      args: [\"--inspect\", tsServerPath].concat(tsServerArgs),\n    }).process\n  } else {\n    return new BufferedNodeProcess({\n      command: tsServerPath,\n      args: tsServerArgs,\n    }).process\n  }\n}\n\nfunction messageStream(input: Readable) {\n  return input.pipe(byline()).pipe(new MessageStream())\n}\n\n/** Helper to parse the tsserver output stream to a message stream  */\nclass MessageStream extends Transform {\n  constructor() {\n    super({objectMode: true})\n  }\n\n  public _transform(buf: Buffer, _encoding: string, callback: (n: Error | undefined) => void) {\n    const line = buf.toString()\n\n    try {\n      if (line.startsWith(\"{\")) {\n        this.push(JSON.parse(line))\n      } else if (!line.startsWith(\"Content-Length:\")) {\n        console.warn(line)\n      }\n    } catch (_) {\n      console.error(\"client: failed to parse: \", line)\n    } finally {\n      callback(undefined)\n    }\n  }\n}\n","import proto from \"typescript/lib/protocol\"\nimport {ReportBusyWhile} from \"../main/pluginManager\"\nimport {CommandRes, CommandsWithCallback, CommandsWithResponse} from \"./commandArgsResponseMap\"\n\ninterface Request {\n  command: CommandsWithCallback\n  started: number\n  reject(err: Error): void\n  resolve(res: any): void\n}\n\n// Callbacks keeps track of all the outstanding requests\nexport class Callbacks {\n  private callbacks: Map<number, Request> = new Map()\n  private interval: number = 0\n\n  constructor(private reportBusyWhile: ReportBusyWhile) {}\n\n  public async add<T extends CommandsWithCallback>(\n    seq: number,\n    command: T,\n  ): Promise<CommandRes<T>> {\n    try {\n      const promise = new Promise<CommandRes<T>>((resolve, reject) => {\n        this.callbacks.set(seq, {\n          command,\n          resolve,\n          reject,\n          started: Date.now(),\n        })\n      })\n      if (this.interval === 0) {\n        this.interval = window.setInterval(() => {\n          process.activateUvLoop()\n        }, 100)\n      }\n      return await this.reportBusyWhile(command, () => promise)\n    } finally {\n      this.callbacks.delete(seq)\n      if (this.interval !== 0 && this.callbacks.size === 0) {\n        clearInterval(this.interval)\n        this.interval = 0\n      }\n    }\n  }\n\n  public rejectAll(error: Error) {\n    for (const {reject} of this.callbacks.values()) {\n      reject(error)\n    }\n\n    this.callbacks.clear()\n  }\n\n  public resolve<T extends CommandsWithResponse>(res: CommandRes<T>): void {\n    const req = this.callbacks.get(res.request_seq)\n    if (req) {\n      if (window.atom_typescript_debug) {\n        console.log(\n          \"received response for\",\n          res.command,\n          \"in\",\n          Date.now() - req.started,\n          \"ms\",\n          \"with data\",\n          res.body,\n        )\n      }\n      if (res.success) req.resolve(res)\n      else req.reject(new Error(res.message))\n    } else console.warn(\"unexpected response:\", res)\n  }\n\n  public resolveMS(body: proto.RequestCompletedEventBody): void {\n    const req = this.callbacks.get(body.request_seq)\n    if (req) {\n      if (window.atom_typescript_debug) {\n        console.log(\n          `received requestCompleted event for multistep command ${req.command} in ${\n            Date.now() - req.started\n          } ms`,\n        )\n      }\n      req.resolve(undefined)\n    } else console.warn(`unexpected requestCompleted event:`, body)\n  }\n\n  public error(seq: number, err: Error): void {\n    const req = this.callbacks.get(seq)\n    if (req) req.reject(err)\n    else console.error(err)\n  }\n}\n","import * as fs from \"fs\"\nimport * as jsonc from \"jsonc-parser\"\nimport * as path from \"path\"\nimport Resolve from \"resolve\"\n\nexport interface Binary {\n  version: string\n  pathToBin: string\n}\n\ninterface ConfigObject {\n  tsdkPath: string\n}\n\ninterface VSCodeConfigObject {\n  \"typescript.tsdk\": string\n}\n\nexport async function resolveBinary(\n  sourcePath: string,\n  binBaseName: \"tsc\" | \"tsserver\",\n): Promise<Binary> {\n  const {NODE_PATH} = process.env as {NODE_PATH?: string}\n  const binName = `${binBaseName}.js`\n\n  const resolvedPath = await resolveModule(`typescript/lib/${binName}`, {\n    basedir: path.dirname(sourcePath),\n    paths: NODE_PATH !== undefined ? NODE_PATH.split(path.delimiter) : undefined,\n  }).catch(async () => {\n    // try to get typescript from auxiliary config file\n    const auxTsdkPath = await getSDKPath(path.dirname(sourcePath))\n    if (auxTsdkPath !== undefined) {\n      const binPath = path.join(auxTsdkPath, \"lib\", binName)\n      const exists = await fsExists(binPath)\n      if (exists) return binPath\n    }\n\n    // try to get typescript from configured tsdkPath\n    const tsdkPath = atom.config.get(\"atom-typescript-updated.tsdkPath\")\n    if (tsdkPath) {\n      const binPath = path.join(tsdkPath, \"lib\", binName)\n      const exists = await fsExists(binPath)\n      if (exists) return binPath\n    }\n\n    // use bundled version\n    const defaultPath = require.resolve(`typescript/lib/${binName}`)\n    return defaultPath\n  })\n\n  const packagePath = path.resolve(resolvedPath, \"../../package.json\")\n  const version: string = require(packagePath).version\n\n  return {\n    version,\n    pathToBin: resolvedPath,\n  }\n}\n\n// Promisify the async resolve function\nasync function resolveModule(id: string, opts: Resolve.AsyncOpts): Promise<string> {\n  return new Promise<string>((resolve, reject) =>\n    Resolve(id, opts, (err, result) => {\n      if (err) {\n        reject(err)\n      } else if (result === undefined) {\n        reject(new Error(\"Module path is undefined\"))\n      } else {\n        resolve(result)\n      }\n    }),\n  )\n}\n\nasync function fsExists(p: string) {\n  return new Promise<boolean>((resolve) =>\n    fs.access(p, fs.constants.F_OK, (err: NodeJS.ErrnoException | null) => {\n      if (err) resolve(false)\n      else resolve(true)\n    }),\n  )\n}\n\nasync function fsReadFile(p: string) {\n  return new Promise<string>((resolve, reject) =>\n    fs.readFile(p, (error, data) => {\n      if (error) reject(error)\n      else resolve(data.toString(\"utf-8\"))\n    }),\n  )\n}\n\nasync function tryConfigFiles(basedir: string, relpaths: string[][]) {\n  for (const relpath of relpaths) {\n    const configFile = path.join(basedir, ...relpath)\n    if (await fsExists(configFile)) return configFile\n  }\n}\n\nasync function resolveConfigFile(initialBaseDir: string) {\n  let basedir = initialBaseDir\n  let parent = path.dirname(basedir)\n  while (basedir !== parent) {\n    const configFile = await tryConfigFiles(basedir, [\n      [\".atom-typescript.json\"],\n      [\".atom\", \"atom-typescript.json\"],\n      [\".vscode\", \"settings.json\"],\n    ])\n    if (configFile !== undefined) return {basedir, configFile}\n    basedir = parent\n    parent = path.dirname(basedir)\n  }\n}\n\nfunction isConfigObject(x: any): x is ConfigObject {\n  return typeof x === \"object\" && x !== null && typeof x.tsdkPath === \"string\"\n}\nfunction isVSCodeConfigObject(x: any): x is VSCodeConfigObject {\n  return typeof x === \"object\" && x !== null && typeof x[\"typescript.tsdk\"] === \"string\"\n}\n\nasync function getSDKPath(dirname: string) {\n  const configFile = await resolveConfigFile(dirname)\n  if (configFile) {\n    try {\n      const configFileContents = jsonc.parse(await fsReadFile(configFile.configFile)) as unknown\n      let tsdkPath\n      if (isConfigObject(configFileContents)) {\n        tsdkPath = configFileContents.tsdkPath\n      } else if (isVSCodeConfigObject(configFileContents)) {\n        // NOTE: VSCode asks for path to \"typescript/lib\", while\n        // we only want path to \"typescript\". Hence the dirname here\n        tsdkPath = path.dirname(configFileContents[\"typescript.tsdk\"])\n      } else {\n        return undefined\n      }\n      return path.isAbsolute(tsdkPath) ? tsdkPath : path.join(configFile.basedir, tsdkPath)\n    } catch (e) {\n      console.warn(e)\n    }\n  }\n}\n","import * as Atom from \"atom\"\nimport {CodeAction, CodeActionProvider} from \"atom-ide-base\"\nimport {CodefixProvider} from \"../atom/codefix/codefixProvider\"\nimport {typeScriptScopes} from \"../atom/utils\"\n\nexport function getCodeActionsProvider(codefixProvider: CodefixProvider): CodeActionProvider {\n  return {\n    grammarScopes: typeScriptScopes(),\n    priority: 0,\n    async getCodeActions(textEditor: Atom.TextEditor, range: Atom.Range): Promise<CodeAction[]> {\n      return (await codefixProvider.runCodeFix(textEditor, range.start)).map((fix) => ({\n        getTitle: async () => (\"description\" in fix ? fix.description : fix.actionDescription),\n        dispose: () => {},\n        apply: async () => {\n          await codefixProvider.applyFix(fix)\n        },\n      }))\n    },\n  }\n}\n","import {CodeHighlightProvider} from \"atom-ide-base\"\nimport {DocumentHighlightsItem} from \"typescript/lib/protocol\"\nimport {GetClientFunction} from \"../../client\"\nimport {\n  getFilePathPosition,\n  isTypescriptEditorWithPath,\n  spanToRange,\n  typeScriptScopes,\n} from \"../atom/utils\"\n\nexport function getCodeHighlightProvider(getClient: GetClientFunction): CodeHighlightProvider {\n  return {\n    grammarScopes: typeScriptScopes(),\n    priority: 100,\n    async highlight(editor, position) {\n      if (!isTypescriptEditorWithPath(editor)) return\n      const location = getFilePathPosition(editor, position)\n      if (!location) return\n      const client = await getClient(location.file)\n      const result = await client.execute(\"documentHighlights\", {\n        ...location,\n        filesToSearch: [location.file],\n      })\n      if (!result.body) return\n      return Array.from(getSpans(location.file, result.body))\n    },\n  }\n}\n\nfunction* getSpans(file: string, data: DocumentHighlightsItem[]) {\n  for (const fileInfo of data) {\n    if (fileInfo.file !== file) continue\n    yield* fileInfo.highlightSpans.map(spanToRange)\n  }\n}\n","import * as Atom from \"atom\"\nimport {Datatip, DatatipProvider} from \"atom-ide-base\"\nimport {GetClientFunction} from \"../../client\"\nimport {renderTooltip} from \"../atom/tooltips/tooltipRenderer\"\nimport {highlight, locationToPoint, typeScriptScopes} from \"../atom/utils\"\n\n// Note: a horrible hack to avoid dependency on React\nconst REACT_ELEMENT_SYMBOL = Symbol.for(\"react.element\")\nconst etch = {\n  dom(type: string, props: any, ...children: any[]): any {\n    if (children.length > 0) {\n      return {\n        $$typeof: REACT_ELEMENT_SYMBOL,\n        type,\n        ref: null,\n        props: {...props, children},\n      }\n    } else {\n      return {\n        $$typeof: REACT_ELEMENT_SYMBOL,\n        type,\n        ref: null,\n        props: {...props},\n      }\n    }\n  },\n}\n\nexport class TSDatatipProvider implements DatatipProvider {\n  public readonly providerName = \"TypeScript type tooltips\"\n  public readonly priority = 100\n  public readonly grammarScopes = typeScriptScopes()\n\n  constructor(private getClient: GetClientFunction) {}\n\n  public async datatip(\n    editor: Atom.TextEditor,\n    bufferPt: Atom.Point,\n  ): Promise<Datatip | undefined> {\n    try {\n      const filePath = editor.getPath()\n      if (filePath === undefined) return\n      const client = await this.getClient(filePath)\n      const result = await client.execute(\"quickinfo\", {\n        file: filePath,\n        line: bufferPt.row + 1,\n        offset: bufferPt.column + 1,\n      })\n      const data = result.body!\n      const tooltip = await renderTooltip(data, etch, highlightCode)\n      return {\n        component: () => <div className=\"atom-typescript-datatip-tooltip\">{tooltip}</div>,\n        range: Atom.Range.fromObject([locationToPoint(data.start), locationToPoint(data.end)]),\n      }\n    } catch (_) {\n      return\n    }\n  }\n}\n\nasync function highlightCode(code: string) {\n  const fontFamily = atom.config.get(\"editor.fontFamily\")\n\n  const html = await highlight(code.replace(/\\r?\\n$/, \"\"), \"source.ts\")\n  return (\n    <div\n      style={{fontFamily}}\n      className=\"atom-typescript-datatip-tooltip-code\"\n      dangerouslySetInnerHTML={{__html: html}}\n    />\n  )\n}\n","export async function renderTooltip(\n  data: protocol.QuickInfoResponseBody | undefined,\n  etch: any,\n  codeRenderer: (code: string) => Promise<JSX.Element> | JSX.Element,\n) {\n  if (data === undefined) return null\n\n  const kind = (\n    <div className=\"atom-typescript-datatip-tooltip-kind\">\n      {data.kind}\n      {formatKindModifiers(data.kindModifiers)}\n    </div>\n  )\n\n  const tags = data.tags\n    ? data.tags.map((tag, idx) => {\n        const tagClass =\n          \"atom-typescript-datatip-tooltip-doc-tag \" +\n          `atom-typescript-datatip-tooltip-doc-tag-name-${tag.name}`\n        return (\n          <div className={tagClass} key={idx}>\n            <span className=\"atom-typescript-datatip-tooltip-doc-tag-name\">{tag.name}</span>\n            {formatTagText(etch, tag.text)}\n          </div>\n        )\n      })\n    : null\n\n  const docs = (\n    <div className=\"atom-typescript-datatip-tooltip-doc\">\n      {data.documentation}\n      {tags}\n    </div>\n  )\n\n  const codeText = data.displayString.replace(/^\\(.+?\\)\\s+/, \"\")\n  return [await codeRenderer(codeText), kind, docs]\n}\n\nfunction formatKindModifiers(etch: any, text?: string) {\n  if (text === undefined) return null\n  return <span className=\"atom-typescript-datatip-tooltip-kind-modifiers\">{text}</span>\n}\n\nfunction formatTagText(etch: any, tagText?: string) {\n  if (tagText === undefined) return null\n\n  const [, firstWord, restOfText] = /^\\s*(\\S*)([^]*)$/.exec(tagText)!\n  return (\n    <span className=\"atom-typescript-datatip-tooltip-doc-tag-text\">\n      <span className=\"atom-typescript-datatip-tooltip-doc-tag-text-first-word\">{firstWord}</span>\n      {restOfText}\n    </span>\n  )\n}\n","import {Definition, DefinitionProvider} from \"atom-ide-base\"\nimport {FileSpan} from \"typescript/lib/protocol\"\nimport {GetClientFunction} from \"../../client\"\nimport {\n  getFilePathPosition,\n  isTypescriptEditorWithPath,\n  spanToRange,\n  typeScriptScopes,\n} from \"../atom/utils\"\n\nexport function getDefinitionProvider(getClient: GetClientFunction): DefinitionProvider {\n  return {\n    name: \"atom-typescript\",\n    priority: 0,\n    grammarScopes: typeScriptScopes(),\n    wordRegExp: /([A-Za-z0-9_])+|['\"`](\\\\.|[^'\"`\\\\\\\\])*['\"`]/g,\n    async getDefinition(editor, position) {\n      if (!isTypescriptEditorWithPath(editor)) return\n      const location = getFilePathPosition(editor, position)\n      if (!location) return\n      const client = await getClient(location.file)\n      const result = await client.execute(\"definition\", location)\n      if (!result.body) return\n      if (result.body.length === 0) return\n\n      return {\n        queryRange: undefined,\n        definitions: result.body.map(fileSpanToDefinition),\n      }\n    },\n  }\n}\n\nfunction fileSpanToDefinition(span: FileSpan): Definition {\n  const range = spanToRange(span)\n  return {\n    path: span.file,\n    position: range.start,\n    range,\n    language: \"TypeScript\",\n  }\n}\n","import {FindReferencesProvider, Reference} from \"atom-ide-base\"\nimport {GetClientFunction} from \"../../client\"\nimport {getFilePathPosition, isTypescriptEditorWithPath, locationsToRange} from \"../atom/utils\"\n\nexport function getFindReferencesProvider(getClient: GetClientFunction): FindReferencesProvider {\n  return {\n    async isEditorSupported(editor) {\n      return isTypescriptEditorWithPath(editor)\n    },\n    async findReferences(editor, position) {\n      const location = getFilePathPosition(editor, position)\n      if (!location) return\n\n      const client = await getClient(location.file)\n      const result = await client.execute(\"references\", location)\n      if (!result.body) return\n      return {\n        type: \"data\",\n        baseUri: location.file,\n        referencedSymbolName: result.body.symbolDisplayString,\n        references: result.body.refs.map(refTsToIde),\n      }\n    },\n  }\n}\n\nfunction refTsToIde(ref: protocol.ReferencesResponseItem): Reference {\n  return {\n    uri: ref.file,\n    range: locationsToRange(ref.start, ref.end),\n    name: undefined,\n  }\n}\n","import * as Atom from \"atom\"\nimport {HyperclickProvider} from \"atom-ide-base\"\nimport {GetClientFunction} from \"../../client\"\nimport {handleFindReferencesResult} from \"../atom/commands/findReferences\"\nimport {handleDefinitionResult} from \"../atom/commands/goToDeclaration\"\nimport {Dependencies} from \"../atom/commands/registry\"\nimport {isTypescriptEditorWithPath} from \"../atom/utils\"\n\nexport function getHyperclickProvider(\n  getClient: GetClientFunction,\n  histGoForward: Dependencies[\"histGoForward\"],\n): HyperclickProvider {\n  return {\n    priority: 0,\n    providerName: \"typescript-hyperclick-provider\",\n    wordRegExp: /([A-Za-z0-9_])+|['\"`](\\\\.|[^'\"`\\\\\\\\])*['\"`]/g,\n    async getSuggestionForWord(editor: Atom.TextEditor, _text: string, range: Atom.Range) {\n      if (!isTypescriptEditorWithPath(editor)) return\n      const filePath = editor.getPath()\n      if (filePath === undefined) return\n\n      return {\n        range,\n        callback: async () => {\n          const location = {\n            file: filePath,\n            line: range.start.row + 1,\n            offset: range.start.column + 1,\n          }\n          const client = await getClient(location.file)\n          const result = await client.execute(\"definition\", location)\n          const resLoc = result.body ? result.body[0] : undefined\n          if (\n            result.body?.length === 1 &&\n            resLoc?.start.line === location.line &&\n            resLoc?.start.offset === location.offset\n          ) {\n            const references = await client.execute(\"references\", location)\n            await handleFindReferencesResult(references, editor, histGoForward)\n          } else {\n            await handleDefinitionResult(result, editor, histGoForward)\n          }\n        },\n      }\n    },\n  }\n}\n","import {TextEditor} from \"atom\"\nimport * as etch from \"etch\"\nimport * as fs from \"fs\"\nimport {TsView} from \"../components/tsView\"\nimport {getFilePathPosition, highlight} from \"../utils\"\nimport {HighlightComponent} from \"../views/highlightComponent\"\nimport {selectListView} from \"../views/simpleSelectionView\"\nimport {addCommand, Dependencies} from \"./registry\"\n\naddCommand(\"atom-text-editor\", \"typescript:find-references\", (deps) => ({\n  description: \"Find where symbol under text cursor is referenced\",\n  async didDispatch(editor) {\n    const location = getFilePathPosition(editor)\n    if (!location) return\n\n    const client = await deps.getClient(location.file)\n    const result = await client.execute(\"references\", location)\n    await handleFindReferencesResult(result, editor, deps.histGoForward)\n  },\n}))\n\nexport async function handleFindReferencesResult(\n  result: protocol.ReferencesResponse,\n  editor: TextEditor,\n  histGoForward: Dependencies[\"histGoForward\"],\n): Promise<void> {\n  const refs = Promise.all(\n    result.body!.refs.map(async (ref) => {\n      const fileContents = (\n        await new Promise<string>((resolve, reject) =>\n          fs.readFile(ref.file, (error, data) => {\n            if (error) reject(error)\n            else resolve(data.toString(\"utf-8\"))\n          }),\n        )\n      ).split(/\\r?\\n/g)\n      const context =\n        ref.contextStart !== undefined && ref.contextEnd !== undefined\n          ? fileContents.slice(ref.contextStart.line - 1, ref.contextEnd.line)\n          : fileContents\n      const fileHlText = (await highlight(context.join(\"\\n\"), \"source.tsx\")).split(\"\\n\")\n      const lineText = fileHlText[ref.start.line - (ref.contextStart?.line ?? 1)]\n      return {...ref, hlText: lineText}\n    }),\n  )\n\n  const res = await selectListView({\n    items: refs,\n    itemTemplate: (item, ctx) => {\n      return (\n        <li>\n          <HighlightComponent\n            label={atom.project.relativize(item.file)}\n            query={ctx.getFilterQuery()}\n          />\n          <div className=\"pull-right\">line: {item.start.line}</div>\n          <TsView highlightedText={item.hlText} />\n        </li>\n      )\n    },\n    itemFilterKey: \"file\",\n  })\n  if (res) await histGoForward(editor, res)\n}\n","import * as etch from \"etch\"\n\ninterface Props extends JSX.Props {\n  highlightedText: string\n}\n\nexport class TsView implements JSX.ElementClass {\n  constructor(public props: Props) {\n    etch.initialize(this)\n  }\n\n  public async update(props: Partial<Props>) {\n    this.props = {...this.props, ...props}\n    return etch.update(this)\n  }\n\n  public render() {\n    const style = {\n      fontFamily: atom.config.get(\"editor.fontFamily\"),\n    }\n    return (\n      <div className=\"editor editor-colors\" style={style} innerHTML={this.props.highlightedText} />\n    )\n  }\n}\n","import * as etch from \"etch\"\nimport {match} from \"fuzzaldrin\"\n\nexport interface Props extends JSX.Props {\n  label: string\n  query: string\n}\n\nexport interface QueryMatch {\n  text: string\n  type?: \"character-match\"\n}\n\nexport class HighlightComponent implements JSX.ElementClass {\n  private matches: QueryMatch[]\n  constructor(public props: Props) {\n    this.matches = this.match(this.props)\n    etch.initialize(this)\n  }\n\n  public async update(props: Partial<Props>) {\n    this.props = {...this.props, ...props}\n    this.matches = this.match(this.props)\n    await etch.update(this)\n  }\n\n  public async destroy() {\n    await etch.destroy(this)\n  }\n\n  public render(): JSX.Element {\n    return (\n      <span>\n        {this.matches.map((m, i) => (\n          <span className={m.type} key={i}>{m.text}</span>\n        ))}\n      </span>\n    )\n  }\n\n  private match(props: Props): QueryMatch[] {\n    if (props.query) {\n      return highlightMatches(props.label, props.query)\n    }\n    return [{text: props.label}]\n  }\n}\n\n// extracted/adapted from symbols-view package (symbols-view.js::SymbolsView.highlightMatches)\nexport function highlightMatches(name: string, query: string): QueryMatch[] {\n  let lastIndex: number = 0\n  let matchedChars: string[] = [] // Build up a set of matched chars to be more semantic\n  const queryMatches: QueryMatch[] = []\n\n  const matches: number[] = match(name, query) as number[]\n  let matchIndex: number\n  for (matchIndex of matches) {\n    if (matchIndex < 0) {\n      continue // If marking up the basename, omit name matches\n    }\n    const unmatched = name.substring(lastIndex, matchIndex)\n    if (unmatched) {\n      if (matchedChars.length > 0) {\n        queryMatches.push({text: matchedChars.join(\"\"), type: \"character-match\"})\n      }\n      matchedChars = []\n      queryMatches.push({text: unmatched})\n    }\n    matchedChars.push(name[matchIndex])\n    lastIndex = matchIndex + 1\n  }\n\n  if (matchedChars.length > 0) {\n    queryMatches.push({text: matchedChars.join(\"\"), type: \"character-match\"})\n  }\n\n  // Remaining characters are plain text\n  queryMatches.push({text: name.substring(lastIndex)})\n\n  return queryMatches\n}\n","import {Panel} from \"atom\"\nimport SelectListView from \"atom-select-list\"\nimport * as etch from \"etch\"\nimport {handlePromise} from \"../../../utils\"\n\nexport interface SelectListViewOptions<T> {\n  items:\n    | ReadonlyArray<T>\n    | Promise<ReadonlyArray<T>>\n    | ((filterText: string) => ReadonlyArray<T>)\n    | ((filterText: string) => Promise<ReadonlyArray<T>>)\n  itemTemplate: (item: T, context: SelectListView<T>) => JSX.Element\n  itemFilterKey: keyof T\n  didChangeSelection?: (item?: T) => void\n}\n\nexport async function selectListView<T>({\n  items,\n  itemTemplate,\n  itemFilterKey,\n  didChangeSelection,\n}: SelectListViewOptions<T>): Promise<T | undefined> {\n  let panel: Panel<SelectListView<T>> | undefined\n  const currentFocus = document.activeElement as HTMLElement | void\n  try {\n    return await new Promise<T | undefined>((resolve) => {\n      let didChangeQuery\n      let loadingMessage: string | undefined = \"Loading...\"\n      let emptyMessage\n      let resolved = false\n      const update = (props: object) => {\n        if (resolved) return\n        handlePromise(select.update(props))\n      }\n      if (typeof items === \"function\") {\n        didChangeQuery = async (query: string) => {\n          const timeout = setTimeout(() => update({loadingMessage: \"Loading...\"}), 300)\n          const is = await items(query)\n          clearTimeout(timeout)\n          update({\n            items: is,\n            emptyMessage: \"Nothing matches the search value\",\n            loadingMessage: undefined,\n          })\n        }\n        loadingMessage = undefined\n        emptyMessage = \"Please enter a search value\"\n      }\n      const select: SelectListView<T> = new SelectListView({\n        items: [] as T[],\n        elementForItem: (item: T) => etch.render(itemTemplate(item, select)) as HTMLElement,\n        filterKeyForItem: (item: T) => `${item[itemFilterKey]}`,\n        didChangeSelection,\n        didCancelSelection: () => {\n          resolved = true\n          resolve(undefined)\n        },\n        didConfirmSelection: (item: T) => {\n          resolved = true\n          resolve(item)\n        },\n        loadingMessage,\n        didChangeQuery,\n        emptyMessage,\n        itemsClassList: [\"atom-typescript\"],\n      })\n      if (typeof items !== \"function\") {\n        handlePromise(\n          Promise.resolve(items).then((is) => {\n            update({items: is, loadingMessage: undefined})\n          }),\n        )\n      }\n      panel = atom.workspace.addModalPanel({\n        item: select,\n        visible: true,\n      })\n      select.focus()\n    })\n  } finally {\n    if (panel) panel.destroy()\n    if (currentFocus) currentFocus.focus()\n  }\n}\n","import * as Atom from \"atom\"\nimport {GetClientFunction} from \"../../../client\"\nimport {ApplyEdits} from \"../../pluginManager\"\nimport {TBuildStatus, TProgress} from \"../components/statusPanel\"\nimport {OpenParams} from \"../editorPositionHistoryManager\"\n\nexport interface Dependencies {\n  getClient: GetClientFunction\n  applyEdits: ApplyEdits\n  clearErrors: () => void\n  killAllServers: () => void\n  reportProgress: (progress: TProgress) => void\n  reportBuildStatus: (status: TBuildStatus | undefined) => void\n  toggleSemanticViewController: () => void\n  toggleFileSymbolsView: (ed: Atom.TextEditor) => void\n  toggleProjectSymbolsView: (ed: Atom.TextEditor) => void\n  histGoForward: (ed: Atom.TextEditor, openParams: OpenParams) => Promise<object>\n  histGoBack: () => Promise<object | undefined>\n  histShowHistory: () => Promise<void>\n  showTooltipAt: (ed: Atom.TextEditor) => void\n  showSigHelpAt: (ed: Atom.TextEditor) => void\n  hideSigHelpAt: (ed: Atom.TextEditor) => boolean\n  rotateSigHelp: (ed: Atom.TextEditor, shift: number) => boolean\n}\n\nexport type AllowedSelectors = keyof Dispatch\n\nexport interface Dispatch {\n  \"atom-text-editor\": (editor: Atom.TextEditor, abort: () => void) => void | Promise<void>\n  \"atom-workspace\": () => void | Promise<void>\n}\n\nexport type CommandDescription = {\n  [Selector in AllowedSelectors]: (deps: Dependencies) => CommandData[Selector]\n}\n\nexport type CommandData = {\n  [Selector in AllowedSelectors]: {\n    didDispatch: Dispatch[Selector]\n    description: string\n    displayName?: string\n  }\n}\n\nexport type CommandDescriptionWithSelector = {\n  [Selector in AllowedSelectors]: {\n    selector: Selector\n    command: string\n    desc: CommandDescription[Selector]\n  }\n}\n\n// To allow using dependency injection, but avoid having to type a lot of boilerplate, we have the\n// individual command files register themselves in the below map. When the package is initializing,\n// the constructors are passed the deps and return the actual commands handlers.\nconst commands: Array<CommandDescriptionWithSelector[AllowedSelectors]> = []\n\nexport function addCommand<Selector extends AllowedSelectors>(\n  selector: Selector,\n  command: string,\n  desc: CommandDescription[Selector],\n) {\n  commands.push({selector, command, desc} as unknown as CommandDescriptionWithSelector[Selector])\n}\n\nexport function getCommands() {\n  return commands\n}\n","import {TextEditor} from \"atom\"\nimport * as etch from \"etch\"\nimport {getFilePathPosition} from \"../utils\"\nimport {HighlightComponent} from \"../views/highlightComponent\"\nimport {selectListView} from \"../views/simpleSelectionView\"\nimport {addCommand, Dependencies} from \"./registry\"\n\naddCommand(\"atom-text-editor\", \"typescript:go-to-declaration\", (deps) => ({\n  description: \"Go to declaration of symbol under text cursor\",\n  async didDispatch(editor) {\n    const location = getFilePathPosition(editor)\n    if (!location) return\n\n    const client = await deps.getClient(location.file)\n    const result = await client.execute(\"definition\", location)\n    await handleDefinitionResult(result, editor, deps.histGoForward)\n  },\n}))\n\nexport async function handleDefinitionResult(\n  result: protocol.DefinitionResponse,\n  editor: TextEditor,\n  histGoForward: Dependencies[\"histGoForward\"],\n): Promise<void> {\n  if (!result.body) {\n    return\n  } else if (result.body.length > 1) {\n    const res = await selectListView({\n      items: result.body,\n      itemTemplate: (item, ctx) => {\n        return (\n          <li>\n            <HighlightComponent label={item.file} query={ctx.getFilterQuery()} />\n            <div className=\"pull-right\">line: {item.start.line}</div>\n          </li>\n        )\n      },\n      itemFilterKey: \"file\",\n    })\n    if (res) await histGoForward(editor, res)\n  } else if (result.body.length > 0) {\n    await histGoForward(editor, result.body[0])\n  }\n}\n","import {OutlineProvider, OutlineTree, OutlineTreeKind} from \"atom-ide-base\"\nimport {NavigationTree, ScriptElementKind} from \"typescript/lib/protocol\"\nimport {GetClientFunction} from \"../../client\"\nimport {spanToRange, typeScriptScopes} from \"../atom/utils\"\n\nexport function getOutlineProvider(getClient: GetClientFunction): OutlineProvider {\n  return {\n    name: \"Atom-TypeScript\",\n    grammarScopes: typeScriptScopes(),\n    priority: 100,\n    updateOnEdit: true,\n    async getOutline(editor) {\n      const filePath = editor.getPath()\n      if (filePath === undefined) return\n      const client = await getClient(filePath)\n      const navTreeResult = await client.execute(\"navtree\", {file: filePath})\n      const navTree = navTreeResult.body\n      if (!navTree) return\n      return {outlineTrees: [navTreeToOutline(navTree)]}\n    },\n  }\n}\n\nfunction navTreeToOutline(navTree: NavigationTree): OutlineTree {\n  const ranges = navTree.spans.map(spanToRange)\n  const range = ranges.reduce((prev, cur) => cur.union(prev))\n  return {\n    kind: kindMap[navTree.kind],\n    plainText: navTree.text,\n    startPosition: range.start,\n    endPosition: range.end,\n    landingPosition: navTree.nameSpan ? spanToRange(navTree.nameSpan).start : undefined,\n    children: navTree.childItems ? navTree.childItems.map(navTreeToOutline).sort(compareNodes) : [],\n  }\n}\n\nfunction compareNodes(a: OutlineTree, b: OutlineTree): number {\n  const apos = a.landingPosition ? a.landingPosition : a.startPosition\n  const bpos = b.landingPosition ? b.landingPosition : b.startPosition\n  return apos.compare(bpos)\n}\n\nconst kindMap: {[key in ScriptElementKind]: OutlineTreeKind | undefined} = {\n  // | \"file\"\n  directory: \"file\",\n  // | \"module\"\n  module: \"module\",\n  \"external module name\": \"module\",\n  // | \"namespace\"\n  // | \"package\"\n  // | \"class\"\n  class: \"class\",\n  \"local class\": \"class\",\n  // | \"method\"\n  method: \"method\",\n  // | \"property\"\n  property: \"property\",\n  getter: \"property\",\n  setter: \"property\",\n  // | \"field\"\n  \"JSX attribute\": \"field\",\n  // | \"constructor\"\n  constructor: \"constructor\",\n  // | \"enum\"\n  enum: \"enum\",\n  // | \"interface\"\n  interface: \"interface\",\n  type: \"interface\",\n  // | \"function\"\n  function: \"function\",\n  \"local function\": \"function\",\n  // | \"variable\"\n  label: \"variable\",\n  alias: \"variable\",\n  var: \"variable\",\n  let: \"variable\",\n  \"local var\": \"variable\",\n  parameter: \"variable\",\n  // | \"constant\"\n  \"enum member\": \"constant\",\n  const: \"constant\",\n  // | \"string\"\n  string: \"string\",\n  // | \"number\"\n  // | \"boolean\"\n  // | \"array\"\n  // ???\n  \"\": undefined,\n  warning: undefined,\n  keyword: undefined,\n  script: undefined,\n  call: undefined,\n  index: undefined,\n  construct: undefined,\n  \"type parameter\": undefined,\n  \"primitive type\": undefined,\n}\n","import {CompositeDisposable, Point, TextEditor} from \"atom\"\nimport {SignatureHelp, SignatureHelpProvider} from \"atom-ide-base\"\nimport {GetClientFunction} from \"../../client\"\nimport {signatureHelpItemToSignature, typeScriptScopes} from \"../atom/utils\"\n\nexport class TSSigHelpProvider implements SignatureHelpProvider {\n  public triggerCharacters = new Set<string>([])\n  public grammarScopes = typeScriptScopes()\n  public priority = 100\n  private disposables = new CompositeDisposable()\n\n  constructor(private getClient: GetClientFunction) {}\n\n  public dispose() {\n    this.disposables.dispose()\n  }\n\n  public async getSignatureHelp(\n    editor: TextEditor,\n    pos: Point,\n  ): Promise<SignatureHelp | undefined> {\n    try {\n      const filePath = editor.getPath()\n      if (filePath === undefined) return\n      const client = await this.getClient(filePath)\n      const result = await client.execute(\"signatureHelp\", {\n        file: filePath,\n        line: pos.row + 1,\n        offset: pos.column + 1,\n      })\n      const data = result.body!\n      const signatures = data.items.map(signatureHelpItemToSignature)\n      return {\n        signatures,\n        activeParameter: data.argumentIndex,\n        activeSignature: data.selectedItemIndex,\n      }\n    } catch (_) {\n      return\n    }\n  }\n}\n","// more: https://github.com/atom-community/autocomplete-plus/wiki/Provider-API\nimport * as Atom from \"atom\"\nimport * as ACP from \"atom/autocomplete-plus\"\nimport * as fuzzaldrin from \"fuzzaldrin\"\nimport {\n  CompletionEntryDetails,\n  CompletionEntryIdentifier,\n  CompletionsTriggerCharacter,\n} from \"typescript/lib/protocol\"\nimport {GetClientFunction, TSClient} from \"../../client\"\nimport {handlePromise} from \"../../utils\"\nimport {ApplyEdits} from \"../pluginManager\"\nimport {codeActionTemplate} from \"./codeActionTemplate\"\nimport {FileLocationQuery, spanToRange, typeScriptScopes} from \"./utils\"\nimport {selectListView} from \"./views/simpleSelectionView\"\n\ntype SuggestionWithDetails = ACP.TextSuggestion & {\n  replacementRange?: Atom.Range\n  isMemberCompletion?: boolean\n  identifier?: CompletionEntryIdentifier | string\n  hasAction?: boolean\n}\n\ninterface Details {\n  details: CompletionEntryDetails\n  rightLabel: string\n  description?: string\n}\n\nexport class AutocompleteProvider implements ACP.AutocompleteProvider {\n  public selector = typeScriptScopes()\n    .map((x) => (x.includes(\".\") ? `.${x}` : x))\n    .join(\", \")\n\n  public inclusionPriority = atom.config.get(\"atom-typescript-updated\").autocompletionInclusionPriority\n  public suggestionPriority = atom.config.get(\"atom-typescript-updated\").autocompletionSuggestionPriority\n  public excludeLowerPriority =\n    atom.config.get(\"atom-typescript-updated\").autocompletionExcludeLowerPriority\n\n  private lastSuggestions?: {\n    // Client used to get the suggestions\n    client: TSClient\n\n    // File and position for the suggestions\n    location: FileLocationQuery\n\n    // Prefix used\n    prefix: string\n\n    // The completions that were returned for the position\n    suggestions: SuggestionWithDetails[]\n    details: Map<string, Details>\n  }\n\n  constructor(private getClient: GetClientFunction, private applyEdits: ApplyEdits) {}\n\n  public async getSuggestions(opts: ACP.SuggestionsRequestedEvent): Promise<ACP.AnySuggestion[]> {\n    const location = getLocationQuery(opts)\n    const prefix = getPrefix(opts)\n\n    if (!location) return []\n\n    // Don't auto-show autocomplete if prefix is empty unless last character is '.'\n    const triggerCharacter = getTrigger(\n      getLastNonWhitespaceChar(opts.editor.getBuffer(), opts.bufferPosition),\n    )\n    if (!prefix && !opts.activatedManually && !triggerCharacter) return []\n\n    // Don't show autocomplete if we're in a string.template and not in a template expression\n    if (\n      containsScope(opts.scopeDescriptor.getScopesArray(), \"string.template.\") &&\n      !containsScope(opts.scopeDescriptor.getScopesArray(), \"template.expression.\")\n    ) {\n      return []\n    }\n\n    try {\n      let suggestions = await this.getSuggestionsWithCache({\n        prefix,\n        location,\n        triggerCharacter,\n        activatedManually: opts.activatedManually,\n      })\n\n      const config = atom.config.get(\"atom-typescript-updated\")\n      if (config.autocompletionUseFuzzyFilter) {\n        suggestions = fuzzaldrin.filter(suggestions, prefix, {\n          key: \"displayText\",\n        })\n      } else {\n        const ignoreCase = config.autocompletionStrictFilterIgnoreCase\n        const longestFirst = config.autocompletionStrictFilterLongestMatchFirst\n        const score = ignoreCase\n          ? (text: string) => {\n              const pos = text.toLowerCase().indexOf(prefix.toLowerCase())\n              const length = text.length * (longestFirst ? -1 : 1)\n              const exact = text.includes(prefix) && prefix.toLowerCase() !== prefix ? -10000 : 0\n              return 100 * pos + exact + length\n            }\n          : (text: string) => {\n              const pos = text.indexOf(prefix)\n              const length = text.length * (longestFirst ? -1 : 1)\n              return 100 * pos + length\n            }\n        const filter = ignoreCase\n          ? (val: {displayText?: string}) =>\n              val.displayText?.toLowerCase().includes(prefix.toLowerCase())\n          : (val: {displayText?: string}) => val.displayText?.includes(prefix)\n        suggestions = suggestions\n          .filter(filter)\n          .sort((a, b) => score(a.displayText!) - score(b.displayText!))\n      }\n\n      return suggestions.map((suggestion) => ({\n        replacementPrefix: suggestion.replacementRange\n          ? opts.editor.getTextInBufferRange(suggestion.replacementRange)\n          : prefix,\n        location,\n        ...this.getDetailsFromCache(suggestion),\n        ...addCallableParens(opts, suggestion),\n      }))\n    } catch (_) {\n      return []\n    }\n  }\n\n  public async getSuggestionDetailsOnSelect(suggestion: ACP.AnySuggestion) {\n    if (\"text\" in suggestion && !(\"rightLabel\" in suggestion)) {\n      return this.getAdditionalDetails(suggestion)\n    } else {\n      return null\n    }\n  }\n\n  public onDidInsertSuggestion(evt: ACP.SuggestionInsertedEvent) {\n    const s = evt.suggestion as SuggestionWithDetails\n    if (!s.hasAction) return\n    if (!this.lastSuggestions) return\n    const client = this.lastSuggestions.client\n    let details = this.getDetailsFromCache(s)\n    handlePromise(\n      (async () => {\n        if (!details) details = await this.getAdditionalDetails(s)\n        if (!details?.details.codeActions) return\n        let action\n        if (details.details.codeActions.length === 1) {\n          action = details.details.codeActions[0]\n        } else {\n          action = await selectListView({\n            items: details.details.codeActions,\n            itemTemplate: codeActionTemplate,\n            itemFilterKey: \"description\",\n          })\n        }\n        if (!action) return\n        await this.applyEdits(action.changes)\n        if (!action.commands) return\n        await Promise.all(\n          action.commands.map((cmd) =>\n            client.execute(\"applyCodeActionCommand\", {\n              command: cmd,\n            }),\n          ),\n        )\n      })(),\n    )\n  }\n\n  private async getAdditionalDetails(suggestion: SuggestionWithDetails) {\n    if (suggestion.identifier === undefined) return null\n    if (!this.lastSuggestions) return null\n    const reply = await this.lastSuggestions.client.execute(\"completionEntryDetails\", {\n      entryNames: [suggestion.identifier],\n      ...this.lastSuggestions.location,\n    })\n    if (!reply.body) return null\n    const [details] = reply.body\n    // apparently, details can be undefined\n    if (!details) return null\n    let parts = details.displayParts\n    if (\n      parts.length >= 3 &&\n      parts[0].text === \"(\" &&\n      parts[1].text === suggestion.leftLabel &&\n      parts[2].text === \")\"\n    ) {\n      parts = parts.slice(3)\n    }\n    let rightLabel = parts.map((d) => d.text).join(\"\")\n    const actionDesc =\n      suggestion.hasAction && details.codeActions?.length === 1\n        ? `${details.codeActions[0].description}\\n\\n`\n        : \"\"\n    if (actionDesc) rightLabel = actionDesc\n    const description =\n      actionDesc +\n      details.displayParts.map((d) => d.text).join(\"\") +\n      (details.documentation ? \"\\n\\n\" + details.documentation.map((d) => d.text).join(\" \") : \"\")\n    this.lastSuggestions.details.set(suggestion.displayText!, {details, rightLabel, description})\n    return {\n      ...suggestion,\n      details,\n      rightLabel,\n      description,\n    }\n  }\n\n  private getDetailsFromCache(suggestion: SuggestionWithDetails) {\n    if (!this.lastSuggestions) return null\n    const d = this.lastSuggestions.details.get(suggestion.displayText!)\n    if (!d) return null\n    return d\n  }\n\n  // Try to reuse the last completions we got from tsserver if they're for the same position.\n  private async getSuggestionsWithCache({\n    prefix,\n    location,\n    triggerCharacter,\n    activatedManually,\n  }: {\n    prefix: string\n    location: FileLocationQuery\n    triggerCharacter?: CompletionsTriggerCharacter\n    activatedManually: boolean\n  }): Promise<SuggestionWithDetails[]> {\n    if (this.lastSuggestions && !activatedManually) {\n      const lastLoc = this.lastSuggestions.location\n      const lastCol = getNormalizedCol(this.lastSuggestions.prefix, lastLoc.offset)\n      const thisCol = getNormalizedCol(prefix, location.offset)\n\n      if (lastLoc.file === location.file && lastLoc.line === location.line && lastCol === thisCol) {\n        if (this.lastSuggestions.suggestions.length !== 0) {\n          return this.lastSuggestions.suggestions\n        }\n      }\n    }\n\n    const client = await this.getClient(location.file)\n    const suggestions = await getSuggestionsInternal({\n      client,\n      location,\n      triggerCharacter: activatedManually ? undefined : triggerCharacter,\n    })\n\n    this.lastSuggestions = {\n      client,\n      location,\n      prefix,\n      suggestions,\n      details: new Map(),\n    }\n\n    return suggestions\n  }\n}\n\nasync function getSuggestionsInternal({\n  client,\n  location,\n  triggerCharacter,\n}: {\n  client: TSClient\n  location: FileLocationQuery\n  triggerCharacter?: CompletionsTriggerCharacter\n}) {\n  if (parseInt(client.version.split(\".\")[0], 10) >= 3) {\n    // use completionInfo\n    const completions = await client.execute(\"completionInfo\", {\n      includeExternalModuleExports: false,\n      includeInsertTextCompletions: true,\n      triggerCharacter,\n      ...location,\n    })\n    return completions.body!.entries.map(\n      completionEntryToSuggestion.bind(null, completions.body?.isMemberCompletion),\n    )\n  } else {\n    // use deprecated completions\n    const completions = await client.execute(\"completions\", {\n      includeExternalModuleExports: false,\n      includeInsertTextCompletions: true,\n      ...location,\n    })\n\n    return completions.body!.map(completionEntryToSuggestion.bind(null, undefined))\n  }\n}\n\n// this should more or less match ES6 specification for valid identifiers\nconst identifierMatch =\n  /(?:(?![\\u{10000}-\\u{10FFFF}])[$_\\p{Lu}\\p{Ll}\\p{Lt}\\p{Lm}\\p{Lo}\\p{Nl}])(?:(?![\\u{10000}-\\u{10FFFF}])[$_\\p{Lu}\\p{Ll}\\p{Lt}\\p{Lm}\\p{Lo}\\p{Nl}\\u200C\\u200D\\p{Mn}\\p{Mc}\\p{Nd}\\p{Pc}])*$/u\n\n// Decide what needs to be replaced in the editor buffer when inserting the completion\nfunction getPrefix(opts: ACP.SuggestionsRequestedEvent): string {\n  // see https://github.com/TypeStrong/atom-typescript/issues/1528\n  // for the motivating example.\n  const line = opts.editor\n    .getBuffer()\n    .getTextInRange([[opts.bufferPosition.row, 0], opts.bufferPosition])\n  const idMatch = line.match(identifierMatch)\n  if (idMatch) return idMatch[0]\n  else return \"\"\n}\n\n// When the user types each character in \".hello\", we want to normalize the column such that it's\n// the same for every invocation of the getSuggestions. In this case, it would be right after \".\"\nfunction getNormalizedCol(prefix: string, col: number): number {\n  const length = prefix === \".\" ? 0 : prefix.length\n  return col - length\n}\n\nfunction getLocationQuery(opts: ACP.SuggestionsRequestedEvent): FileLocationQuery | undefined {\n  const path = opts.editor.getPath()\n  if (path === undefined) {\n    return undefined\n  }\n  return {\n    file: path,\n    line: opts.bufferPosition.row + 1,\n    offset: opts.bufferPosition.column + 1,\n  }\n}\n\nfunction getLastNonWhitespaceChar(buffer: Atom.TextBuffer, pos: Atom.Point): string | undefined {\n  let lastChar: string | undefined\n  const range = new Atom.Range([0, 0], pos)\n  buffer.backwardsScanInRange(\n    /\\S/,\n    range,\n    ({matchText, stop}: {matchText: string; stop: () => void}) => {\n      lastChar = matchText\n      stop()\n    },\n  )\n  return lastChar\n}\n\nfunction containsScope(scopes: ReadonlyArray<string>, matchScope: string): boolean {\n  for (const scope of scopes) {\n    if (scope.includes(matchScope)) {\n      return true\n    }\n  }\n\n  return false\n}\n\nfunction completionEntryToSuggestion(\n  isMemberCompletion: boolean | undefined,\n  entry: protocol.CompletionEntry,\n): SuggestionWithDetails {\n  return {\n    displayText: entry.name,\n    text: entry.insertText !== undefined ? entry.insertText : entry.name,\n    leftLabel: entry.kind,\n    replacementRange: entry.replacementSpan ? spanToRange(entry.replacementSpan) : undefined,\n    type: kindMap[entry.kind],\n    isMemberCompletion,\n    identifier: entry.source !== undefined ? {name: entry.name, source: entry.source} : entry.name,\n    hasAction: entry.hasAction,\n  }\n}\n\nfunction parens(opts: ACP.SuggestionsRequestedEvent) {\n  const buffer = opts.editor.getBuffer()\n  const pt = opts.bufferPosition\n  const lookahead = buffer.getTextInRange([pt, [pt.row, buffer.lineLengthForRow(pt.row)]])\n  return !!lookahead.match(/\\s*\\(/)\n}\n\nfunction addCallableParens(\n  opts: ACP.SuggestionsRequestedEvent,\n  s: SuggestionWithDetails,\n): ACP.TextSuggestion | ACP.SnippetSuggestion {\n  if (\n    atom.config.get(\"atom-typescript-updated.autocompleteParens\") &&\n    [\"function\", \"method\"].includes(s.leftLabel!) &&\n    !parens(opts)\n  ) {\n    return {...s, snippet: `${s.text}($1)`, text: undefined}\n  } else return s\n}\n\n/** From :\n * https://github.com/atom-community/autocomplete-plus/pull/334#issuecomment-85697409\n */\ntype ACPCompletionType =\n  | \"variable\"\n  | \"constant\"\n  | \"property\"\n  | \"value\"\n  | \"method\"\n  | \"function\"\n  | \"class\"\n  | \"type\"\n  | \"keyword\"\n  | \"tag\"\n  | \"import\"\n  | \"require\"\n  | \"snippet\"\n\nconst kindMap: {[key in protocol.ScriptElementKind]: ACPCompletionType | undefined} = {\n  directory: \"require\",\n  module: \"import\",\n  \"external module name\": \"import\",\n  class: \"class\",\n  \"local class\": \"class\",\n  method: \"method\",\n  property: \"property\",\n  getter: \"property\",\n  setter: \"property\",\n  \"JSX attribute\": \"property\",\n  constructor: \"method\",\n  enum: \"type\",\n  interface: \"type\",\n  type: \"type\",\n  \"type parameter\": \"type\",\n  \"primitive type\": \"type\",\n  function: \"function\",\n  \"local function\": \"function\",\n  label: \"variable\",\n  alias: \"import\",\n  var: \"variable\",\n  let: \"variable\",\n  \"local var\": \"variable\",\n  parameter: \"variable\",\n  \"enum member\": \"constant\",\n  const: \"constant\",\n  string: \"value\",\n  keyword: \"keyword\",\n  \"\": undefined,\n  warning: undefined,\n  script: undefined,\n  call: undefined,\n  index: undefined,\n  construct: undefined,\n}\n\n// This may look strange, but it guarantees the list is consistent with the type\nconst triggerCharactersMap: {[K in CompletionsTriggerCharacter]: null} = {\n  \".\": null,\n  '\"': null,\n  \"'\": null,\n  \"`\": null,\n  \"/\": null,\n  \"@\": null,\n  \"<\": null,\n  \"#\": null,\n}\nconst triggerCharacters = new Set<CompletionsTriggerCharacter>(Object.keys(triggerCharactersMap))\nfunction getTrigger(prefix: string | undefined): CompletionsTriggerCharacter | undefined {\n  if (prefix === undefined) return undefined\n  if (!prefix) return undefined\n  const c = prefix.slice(-1)\n  if (triggerCharacters.has(c as CompletionsTriggerCharacter)) {\n    return c as CompletionsTriggerCharacter\n  }\n  return undefined\n}\n","import * as etch from \"etch\"\nimport {CodeAction} from \"typescript/lib/protocol\"\n\nexport function codeActionTemplate(codeAction: CodeAction) {\n  return <li>{codeAction.description}</li>\n}\n","export {CodefixProvider} from \"./codefixProvider\"\n","import * as Atom from \"atom\"\nimport {ClientResolver, TSClient} from \"../../../client\"\nimport {ErrorPusher} from \"../../errorPusher\"\nimport {ApplyEdits} from \"../../pluginManager\"\nimport {\n  applyRefactors,\n  getApplicableRefactorsActions,\n  RefactorAction,\n} from \"../commands/refactorCode\"\nimport {pointToLocation, spanToRange} from \"../utils\"\n\nexport class CodefixProvider {\n  private supportedFixes: WeakMap<TSClient, Set<number>> = new WeakMap()\n\n  constructor(\n    private clientResolver: ClientResolver,\n    private errorPusher: ErrorPusher,\n    private applyEdits: ApplyEdits,\n  ) {}\n\n  public async getFixableRanges(textEditor: Atom.TextEditor, range: Atom.Range) {\n    const filePath = textEditor.getPath()\n    if (filePath === undefined) return []\n    const errors = this.errorPusher.getErrorsInRange(filePath, range)\n    const client = await this.clientResolver.get(filePath)\n    const supportedCodes = await this.getSupportedFixes(client)\n\n    const ranges = Array.from(errors)\n      .filter((error) => error.code !== undefined && supportedCodes.has(error.code))\n      .map((error) => spanToRange(error))\n\n    return ranges\n  }\n\n  public async runCodeFix(\n    textEditor: Atom.TextEditor,\n    bufferPosition: Atom.Point,\n  ): Promise<Array<protocol.CodeAction | RefactorAction>> {\n    const filePath = textEditor.getPath()\n\n    if (filePath === undefined) return []\n\n    const client = await this.clientResolver.get(filePath)\n    const supportedCodes = await this.getSupportedFixes(client)\n\n    const requests = Array.from(this.errorPusher.getErrorsAt(filePath, bufferPosition))\n      .filter((error) => error.code !== undefined && supportedCodes.has(error.code))\n      .map((error) =>\n        client.execute(\"getCodeFixes\", {\n          file: filePath,\n          startLine: error.start.line,\n          startOffset: error.start.offset,\n          endLine: error.end.line,\n          endOffset: error.end.offset,\n          errorCodes: [error.code!],\n        }),\n      )\n\n    const fixes = await Promise.all(requests)\n    const results: Array<protocol.CodeAction | RefactorAction> = []\n\n    for (const result of fixes) {\n      if (result.body) {\n        for (const fix of result.body) {\n          results.push(fix)\n        }\n      }\n    }\n\n    const refactors = await getApplicableRefactorsActions(client, {\n      file: filePath,\n      ...pointToLocation(bufferPosition),\n    })\n\n    results.push(...refactors)\n\n    return results\n  }\n\n  public async applyFix(fix: protocol.CodeAction | RefactorAction) {\n    if (\"changes\" in fix) return this.applyEdits(fix.changes)\n    else {\n      const client = await this.clientResolver.get(fix.refactorRange.file)\n      return applyRefactors(fix, client, {\n        applyEdits: this.applyEdits,\n      })\n    }\n  }\n\n  public dispose() {\n    // NOOP\n  }\n\n  private async getSupportedFixes(client: TSClient) {\n    let codes = this.supportedFixes.get(client)\n    if (codes) {\n      return codes\n    }\n\n    const result = await client.execute(\"getSupportedCodeFixes\")\n\n    if (!result.body) {\n      throw new Error(\"No code fixes are supported\")\n    }\n\n    codes = new Set(result.body.map((code) => parseInt(code, 10)))\n    this.supportedFixes.set(client, codes)\n    return codes\n  }\n}\n","import * as etch from \"etch\"\nimport protocol from \"typescript/lib/protocol\"\nimport {TSClient} from \"../../../client\"\nimport {getFilePathPosition} from \"../utils\"\nimport {HighlightComponent} from \"../views/highlightComponent\"\nimport {selectListView} from \"../views/simpleSelectionView\"\nimport {addCommand, Dependencies} from \"./registry\"\n\nexport interface RefactorAction {\n  refactorName: string\n  refactorDescription: string\n  refactorRange: protocol.FileLocationOrRangeRequestArgs\n  actionName: string\n  actionDescription: string\n  inlineable: boolean\n}\n\naddCommand(\"atom-text-editor\", \"typescript:refactor-selection\", (deps) => ({\n  description: \"Get a list of applicable refactors to selected code\",\n  async didDispatch(editor) {\n    const location = getFilePathPosition(editor)\n    if (!location) return\n\n    const selection = editor.getSelectedBufferRange()\n    const client = await deps.getClient(location.file)\n\n    const fileRange: protocol.FileLocationOrRangeRequestArgs = selection.isEmpty()\n      ? location\n      : {\n          file: location.file,\n          startLine: selection.start.row + 1,\n          startOffset: selection.start.column + 1,\n          endLine: selection.end.row + 1,\n          endOffset: selection.end.column + 1,\n        }\n\n    const actions = await getApplicableRefactorsActions(client, fileRange)\n\n    if (actions.length === 0) {\n      atom.notifications.addInfo(\"AtomTS: No applicable refactors for the selection\")\n      return\n    }\n\n    const selectedAction = await selectListView({\n      items: actions,\n      itemTemplate: (item, ctx) => {\n        return (\n          <li>\n            <HighlightComponent\n              label={`${item.refactorDescription}: ${item.actionDescription}`}\n              query={ctx.getFilterQuery()}\n            />\n          </li>\n        )\n      },\n      itemFilterKey: \"actionDescription\",\n    })\n\n    if (selectedAction === undefined) return\n    await applyRefactors(selectedAction, client, deps)\n  },\n}))\n\nexport async function getApplicableRefactorsActions(\n  client: TSClient,\n  pointOrRange: protocol.FileLocationOrRangeRequestArgs,\n) {\n  const responseApplicable = await getApplicabeRefactors(client, pointOrRange)\n  if (!responseApplicable) return []\n  if (responseApplicable.body === undefined || responseApplicable.body.length === 0) {\n    return []\n  }\n\n  const actions: RefactorAction[] = []\n  for (const refactor of responseApplicable.body) {\n    for (const action of refactor.actions) {\n      actions.push({\n        refactorName: refactor.name,\n        refactorDescription: refactor.description,\n        refactorRange: pointOrRange,\n        actionName: action.name,\n        actionDescription: action.description,\n        inlineable: refactor.inlineable !== undefined ? refactor.inlineable : true,\n      })\n    }\n  }\n\n  return actions\n}\n\nasync function getApplicabeRefactors(\n  client: TSClient,\n  pointOrRange: protocol.FileLocationOrRangeRequestArgs,\n) {\n  try {\n    return await client.execute(\"getApplicableRefactors\", {\n      triggerReason: \"invoked\",\n      ...pointOrRange,\n    })\n  } catch {\n    return undefined\n  }\n}\n\nexport async function applyRefactors(\n  selectedAction: RefactorAction,\n  client: TSClient,\n  deps: Pick<Dependencies, \"applyEdits\">,\n) {\n  const responseEdits = await client.execute(\"getEditsForRefactor\", {\n    ...selectedAction.refactorRange,\n    refactor: selectedAction.refactorName,\n    action: selectedAction.actionName,\n  })\n\n  if (responseEdits.body === undefined) return\n  const {edits, renameFilename, renameLocation} = responseEdits.body\n\n  await deps.applyEdits(edits)\n\n  if (renameFilename === undefined || renameLocation === undefined) return\n\n  const editor = await atom.workspace.open(renameFilename, {\n    searchAllPanes: true,\n    initialLine: renameLocation.line - 1,\n    initialColumn: renameLocation.offset - 1,\n  })\n  await atom.commands.dispatch(atom.views.getView(editor), \"typescript:rename-refactor\")\n}\n","import * as Atom from \"atom\"\nimport {handlePromise} from \"../../../utils\"\nimport {CodefixProvider} from \"./codefixProvider\"\n\ninterface Intention {\n  priority: number\n  icon?: string\n  class?: string\n  title: string\n  selected: () => void\n}\n\ninterface IntentionHighlight {\n  range: Atom.Range\n  created: (args: CreatedCallbackArgs) => void\n}\n\ninterface CreatedCallbackArgs {\n  textEditor: Atom.TextEditor\n  element: HTMLElement\n  marker: Atom.DisplayMarker\n  matchedText: string\n}\n\ninterface IntentionsProviderInterface {\n  grammarScopes: string[]\n  getIntentions: (opts: GetIntentionsOptions) => Intention[] | Promise<Intention[]>\n}\n\ninterface IntentionsHighlightsProviderInterface {\n  grammarScopes: string[]\n  getIntentions: (\n    opts: GetIntentionsHighlightsOptions,\n  ) => IntentionHighlight[] | Promise<IntentionHighlight[]>\n}\n\ninterface GetIntentionsOptions {\n  bufferPosition: Atom.Point\n  textEditor: Atom.TextEditor\n}\n\ninterface GetIntentionsHighlightsOptions {\n  visibleRange: Atom.Range\n  textEditor: Atom.TextEditor\n}\n\nexport function getIntentionsProvider(\n  codefixProvider: CodefixProvider,\n): IntentionsProviderInterface {\n  return {\n    grammarScopes: [\"*\"],\n    async getIntentions({bufferPosition, textEditor}) {\n      return (await codefixProvider.runCodeFix(textEditor, bufferPosition)).map((fix) => ({\n        priority: 100,\n        title: \"description\" in fix ? fix.description : fix.actionDescription,\n        selected: () => {\n          handlePromise(codefixProvider.applyFix(fix))\n        },\n      }))\n    },\n  }\n}\n\nexport function getIntentionsHighlightsProvider(\n  codefixProvider: CodefixProvider,\n): IntentionsHighlightsProviderInterface {\n  return {\n    grammarScopes: [\"*\"],\n    async getIntentions({visibleRange, textEditor}) {\n      return (await codefixProvider.getFixableRanges(textEditor, visibleRange)).map((range) => ({\n        range,\n        created: (_opts: CreatedCallbackArgs) => {\n          // NOOP\n        },\n      }))\n    },\n  }\n}\n","import {CompositeDisposable, DisposableLike} from \"atom\"\nimport {isTypescriptEditorWithPath, isTypescriptGrammar} from \"../utils\"\nimport {Dependencies, getCommands} from \"./registry\"\n\n// Import all of the command files for their side effects\nimport \"./build\"\nimport \"./checkAllFiles\"\nimport \"./clearErrors\"\nimport \"./findReferences\"\nimport \"./formatCode\"\nimport \"./goToDeclaration\"\nimport \"./initializeConfig\"\nimport \"./organizeImports\"\nimport \"./refactorCode\"\nimport \"./reloadProjects\"\nimport \"./renameFile\"\nimport \"./renameRefactor\"\nimport \"./restartAllServers\"\nimport \"./returnFromDeclaration\"\nimport \"./semanticView\"\nimport \"./showTooltip\"\nimport \"./sigHelp\"\nimport \"./symbolsView\"\n\nexport function registerCommands(deps: Dependencies): DisposableLike {\n  const disp = new CompositeDisposable()\n  for (const cmd of getCommands()) {\n    if (cmd.selector === \"atom-text-editor\") {\n      const d = cmd.desc(deps)\n      disp.add(\n        atom.commands.add(cmd.selector, cmd.command, {\n          ...d,\n          async didDispatch(e) {\n            try {\n              const editor = e.currentTarget.getModel()\n              if (isTypescriptEditorWithPath(editor)) {\n                await d.didDispatch(editor, () => e.abortKeyBinding())\n              } else {\n                e.abortKeyBinding()\n                if (isTypescriptGrammar(editor)) {\n                  atom.notifications.addWarning(\n                    \"Atom-TypeScript cancelled last command: Current editor has no file path\",\n                    {\n                      description:\n                        \"Atom-TypeScript needs to determine the file path of the \" +\n                        `current editor to execute \\`${cmd.command}\\`, which it failed to do. ` +\n                        \"You probably just need to save the current file somewhere.\",\n                      dismissable: true,\n                    },\n                  )\n                }\n              }\n            } catch (error) {\n              handle(error as Error)\n            }\n          },\n        }),\n      )\n    } else {\n      const d = cmd.desc(deps)\n      disp.add(\n        atom.commands.add(cmd.selector, cmd.command, {\n          ...d,\n          async didDispatch() {\n            try {\n              await d.didDispatch()\n            } catch (error) {\n              handle(error as Error)\n            }\n          },\n        }),\n      )\n    }\n  }\n  return disp\n}\n\nfunction handle(err: Error) {\n  if (err.message === \"Server stopped normally\") {\n    console.warn(\"TypeScript server exited normally while executing a command\", err)\n  } else {\n    atom.notifications.addFatalError(\"Something went wrong, see details below.\", {\n      detail: err.message,\n      dismissable: true,\n      stack: err.stack,\n    })\n  }\n}\n","import {addCommand} from \"./registry\"\n\naddCommand(\"atom-text-editor\", \"typescript:build\", (deps) => ({\n  description: \"Compile all files in project related to current active text editor\",\n  async didDispatch(editor) {\n    const file = editor.getPath()\n    if (file === undefined) return\n    const client = await deps.getClient(file)\n\n    deps.reportBuildStatus(undefined)\n\n    const projectInfo = await client.execute(\"projectInfo\", {\n      file,\n      needFileNameList: true,\n    })\n\n    const files = new Set(projectInfo.body!.fileNames)\n    files.delete(projectInfo.body!.configFileName)\n    let filesSoFar = 0\n    const promises = [...files.values()].map((f) =>\n      _finally(client.execute(\"compileOnSaveEmitFile\", {file: f, forced: true}), () => {\n        filesSoFar += 1\n        deps.reportProgress({max: files.size, value: filesSoFar})\n      }),\n    )\n\n    try {\n      const results = await Promise.all(promises)\n      if (results.some((result) => result.body === false)) {\n        throw new Error(\"Emit failed\")\n      }\n      deps.reportBuildStatus({success: true})\n    } catch (error) {\n      const err = error as Error\n      console.error(err)\n      deps.reportBuildStatus({success: false, message: err.message})\n    }\n  },\n}))\n\nfunction _finally<T>(promise: Promise<T>, callback: (result: T) => void): Promise<T> {\n  promise.then(callback, callback)\n  return promise\n}\n","import * as path from \"path\"\nimport {addCommand} from \"./registry\"\n\naddCommand(\"atom-text-editor\", \"typescript:check-all-files\", (deps) => ({\n  description: \"Typecheck all files in project related to current active text editor\",\n  async didDispatch(editor) {\n    const file = editor.getPath()\n    if (file === undefined) return\n    const client = await deps.getClient(file)\n\n    const projectInfo = await client.execute(\"projectInfo\", {\n      file,\n      needFileNameList: true,\n    })\n\n    const files = new Set(\n      projectInfo.body!.fileNames?.filter(\n        (fn) =>\n          // filter out obvious potholes\n          !fn.endsWith(\"tsconfig.json\") && !fn.includes(`${path.sep}node_modules${path.sep}`),\n      ),\n    )\n    const max = files.size\n\n    // There's no real way to know when all of the errors have been received and not every file from\n    // the files set is going to receive a a diagnostic event (typically some d.ts files). To counter\n    // that, we cancel the listener and close the progress bar after no diagnostics have been received\n    // for some amount of time.\n    // That is, if we can't rely on multistep\n    if (client.multistepSupported) {\n      const disp = client.on(\"syntaxDiag\", (evt) => {\n        if (\"file\" in evt) files.delete(evt.file)\n        deps.reportProgress({max, value: max - files.size})\n      })\n\n      deps.reportProgress({max, value: 0})\n      await client.execute(\"geterrForProject\", {file, delay: 0})\n      disp.dispose()\n    } else {\n      let cancelTimeout: number | undefined\n\n      const disp = client.on(\"syntaxDiag\", (evt) => {\n        if (cancelTimeout !== undefined) window.clearTimeout(cancelTimeout)\n        cancelTimeout = window.setTimeout(() => {\n          files.clear()\n          disp.dispose()\n          deps.reportProgress({max, value: max})\n        }, 2000)\n\n        if (\"file\" in evt) files.delete(evt.file)\n        if (files.size === 0) {\n          disp.dispose()\n          window.clearTimeout(cancelTimeout)\n        }\n        deps.reportProgress({max, value: max - files.size})\n      })\n\n      deps.reportProgress({max, value: 0})\n      await client.execute(\"geterrForProject\", {file, delay: 0})\n    }\n  },\n}))\n","import {addCommand} from \"./registry\"\n\naddCommand(\"atom-workspace\", \"typescript:clear-errors\", (deps) => ({\n  description: \"Clear error messages\",\n  didDispatch() {\n    deps.clearErrors()\n  },\n}))\n","import {TextEditor} from \"atom\"\nimport {CodeEdit, LocationRangeQuery, rangeToLocationRange, spanToRange} from \"../utils\"\nimport {addCommand} from \"./registry\"\n\naddCommand(\"atom-text-editor\", \"typescript:format-code\", (deps) => ({\n  description: \"Format code in currently active text editor\",\n  async didDispatch(editor) {\n    const filePath = editor.getPath()\n    if (filePath === undefined) return\n\n    const ranges: LocationRangeQuery[] = []\n\n    for (const selection of editor.getSelectedBufferRanges()) {\n      if (!selection.isEmpty()) {\n        ranges.push(rangeToLocationRange(selection))\n      }\n    }\n\n    // Format the whole document if there are no ranges added\n    if (ranges.length === 0) {\n      const end = editor.getBuffer().getEndPosition()\n      ranges.push({\n        line: 1,\n        offset: 1,\n        endLine: end.row + 1,\n        endOffset: end.column + 1,\n      })\n    }\n\n    const client = await deps.getClient(filePath)\n    const edits: CodeEdit[] = []\n\n    // Collect all edits together so we can update everything in a single transaction\n    for (const range of ranges) {\n      const result = await client.execute(\"format\", {...range, file: filePath})\n      if (result.body) {\n        edits.push(...result.body)\n      }\n    }\n\n    if (edits.length > 0) {\n      editor.transact(() => {\n        formatCode(editor, edits)\n      })\n    }\n  },\n}))\n\nfunction formatCode(editor: TextEditor, edits: CodeEdit[]) {\n  // The code edits need to be applied in reverse order\n  for (let i = edits.length - 1; i >= 0; i--) {\n    editor.setTextInBufferRange(spanToRange(edits[i]), edits[i].newText)\n  }\n}\n","import {BufferedNodeProcess} from \"atom\"\nimport {resolveBinary} from \"../../../client\"\nimport {addCommand} from \"./registry\"\n\naddCommand(\"atom-text-editor\", \"typescript:initialize-config\", () => ({\n  description: \"Create tsconfig.json in the project related to currently-active text edtior\",\n  async didDispatch(editor, abort) {\n    const projectDirs = atom.project.getDirectories()\n    if (projectDirs.length === 0) return abort()\n\n    const currentPath = editor.getPath()\n    if (currentPath === undefined) return\n\n    const pathToTsc = (await resolveBinary(currentPath, \"tsc\")).pathToBin\n\n    for (const projectDir of projectDirs) {\n      if (projectDir.contains(currentPath)) {\n        await initConfig(pathToTsc, projectDir.getPath())\n        atom.notifications.addSuccess(\n          `Successfully created tsconfig.json in ${projectDir.getPath()}`,\n        )\n      }\n    }\n  },\n}))\n\nasync function initConfig(tsc: string, projectRoot: string): Promise<void> {\n  let disp: {dispose: () => void} | undefined\n  try {\n    return await new Promise<void>((resolve, reject) => {\n      try {\n        const bnp = new BufferedNodeProcess({\n          command: tsc,\n          args: [\"--init\"],\n          options: {cwd: projectRoot},\n          exit: (code) => {\n            if (code === 0) resolve()\n            else reject(new Error(`Tsc ended with nonzero exit code ${code}`))\n          },\n        })\n        disp = bnp.onWillThrowError(reject)\n      } catch (e) {\n        reject(e)\n      }\n    })\n  } finally {\n    if (disp) disp.dispose()\n  }\n}\n","import {addCommand} from \"./registry\"\n\naddCommand(\"atom-text-editor\", \"typescript:organize-imports\", (deps) => ({\n  description: \"Organize module imports\",\n  async didDispatch(editor) {\n    const filePath = editor.getPath()\n    if (filePath === undefined) return\n\n    const client = await deps.getClient(filePath)\n    const result = await client.execute(\"organizeImports\", {\n      scope: {type: \"file\", args: {file: filePath}},\n    })\n    if (result.body.length > 0) await deps.applyEdits(result.body)\n  },\n}))\n","import {addCommand} from \"./registry\"\n\naddCommand(\"atom-text-editor\", \"typescript:reload-projects\", (deps) => ({\n  description: \"Reload projects\",\n  async didDispatch(editor) {\n    const path = editor.getPath()\n    if (path === undefined) return\n    const client = await deps.getClient(path)\n    await client.execute(\"reloadProjects\")\n  },\n}))\n","import * as fs from \"fs-plus\"\nimport {showRenameDialog} from \"../views/renameView\"\nimport {addCommand} from \"./registry\"\n\naddCommand(\"atom-text-editor\", \"typescript:rename-file\", (deps) => ({\n  description: \"Rename current file\",\n  async didDispatch(editor) {\n    const location = editor.getPath()\n    if (!location) return\n\n    const newLocation = await showRenameDialog({\n      autoSelect: true,\n      title: \"Rename File\",\n      text: location,\n      onValidate: (newText): string => {\n        if (!newText.trim()) {\n          return \"If you want to abort : Press esc to exit\"\n        }\n        return \"\"\n      },\n    })\n\n    if (!newLocation) return\n\n    const client = await deps.getClient(location)\n    const response = await client.execute(\"getEditsForFileRename\", {\n      oldFilePath: location,\n      newFilePath: newLocation,\n    })\n\n    await deps.applyEdits(response.body)\n\n    await new Promise<void>((resolve, reject) => {\n      fs.move(location, newLocation, (err?: Error) => {\n        if (err) reject(err)\n        else {\n          editor.getBuffer().setPath(newLocation)\n          resolve()\n        }\n      })\n    })\n  },\n}))\n","import {CompositeDisposable} from \"atom\"\nimport * as etch from \"etch\"\nimport {handlePromise} from \"../../../utils\"\nimport {MiniEditor} from \"../components/miniEditor\"\n\ninterface Props extends JSX.Props {\n  validationMessage?: string\n  title: string\n  initialText: string\n  selectAll: boolean\n}\n\nexport interface Options {\n  autoSelect: boolean\n  title: string\n  text: string\n  onValidate: (newValue: string) => string\n}\n\nclass RenameView implements JSX.ElementClass {\n  public refs!: {\n    editor: MiniEditor\n    main: HTMLElement\n  }\n\n  constructor(public props: Props) {\n    etch.initialize(this)\n  }\n\n  public async update(props: Partial<Props>) {\n    this.props = {...this.props, ...props}\n    await etch.update(this)\n  }\n\n  public render() {\n    return (\n      <div className=\"atomts-rename-view\" ref=\"main\">\n        <div className=\"block\">\n          <div>\n            <span ref=\"title\">{this.props.title}</span>\n            <span className=\"subtle-info-message\">\n              <span>Close this panel with </span>\n              <span className=\"highlight\">esc</span>\n              <span> key. And commit with the </span>\n              <span className=\"highlight\">enter</span>\n              <span> key.</span>\n            </span>\n          </div>\n          <div className=\"find-container block\">\n            <div className=\"editor-container\">\n              <MiniEditor\n                ref=\"editor\"\n                initialText={this.props.initialText}\n                selectAll={this.props.selectAll}\n              />\n            </div>\n          </div>\n          {this.renderValidationMessage()}\n        </div>\n      </div>\n    )\n  }\n\n  public async destroy() {\n    await etch.destroy(this)\n  }\n\n  public focus() {\n    return this.refs.editor.focus()\n  }\n\n  public getText() {\n    return this.refs.editor.getModel().getText()\n  }\n\n  private renderValidationMessage(): JSX.Element | null {\n    if (this.props.validationMessage !== undefined) {\n      return <div className=\"highlight-error\">{this.props.validationMessage}</div>\n    }\n    return null\n  }\n}\n\n// Show the dialog and resolve the promise with the entered string\nexport async function showRenameDialog(options: Options): Promise<string | undefined> {\n  const item = new RenameView({\n    title: options.title,\n    initialText: options.text,\n    selectAll: options.autoSelect,\n  })\n  const panel = atom.workspace.addModalPanel({\n    item,\n    priority: 1000,\n  })\n\n  const currentFocus = document.activeElement as HTMLElement | void\n\n  item.focus()\n\n  const disposables = new CompositeDisposable()\n  try {\n    return await new Promise<string | undefined>((resolve) => {\n      disposables.add(\n        atom.commands.add(item.refs.main, {\n          \"core:cancel\": () => {\n            resolve(undefined)\n          },\n          \"core:confirm\": () => {\n            const newText = item.getText()\n            const invalid = options.onValidate(newText)\n            if (invalid) {\n              handlePromise(item.update({validationMessage: invalid}))\n              return\n            }\n            resolve(newText)\n          },\n        }),\n      )\n    })\n  } finally {\n    panel.destroy()\n    disposables.dispose()\n    if (currentFocus) currentFocus.focus()\n  }\n}\n","import {TextEditor, TextEditorElement} from \"atom\"\n\ninterface Props extends JSX.Props {\n  initialText: string\n  selectAll?: boolean\n  readOnly?: boolean\n  grammar?: string\n}\n\nexport class MiniEditor implements JSX.ElementClass {\n  public element: TextEditorElement\n  private model: TextEditor\n\n  constructor(public props: Props) {\n    this.model = atom.workspace.buildTextEditor({\n      mini: true,\n      softWrapped: true,\n      lineNumberGutterVisible: false,\n    })\n    this.element = atom.views.getView(this.model)\n    this.model.setText(props.initialText)\n    if (props.selectAll) {\n      this.model.selectAll()\n    } else {\n      this.model.getLastCursor().moveToEndOfScreenLine()\n    }\n    this.setReadOnly()\n    this.setGrammar()\n    this.model.scrollToBufferPosition([0, 0])\n  }\n\n  public async update(props: Partial<Props>) {\n    this.element = atom.views.getView(this.model)\n    this.props = {...this.props, ...props}\n    this.setReadOnly()\n    this.setGrammar()\n  }\n\n  public focus() {\n    this.element.focus()\n  }\n\n  public getModel() {\n    return this.model\n  }\n\n  private setReadOnly() {\n    this.model.setReadOnly(!!this.props.readOnly)\n  }\n\n  private setGrammar() {\n    if (this.props.grammar !== undefined) {\n      atom.textEditors.setGrammarOverride(this.model, this.props.grammar)\n    } else {\n      atom.textEditors.clearGrammarOverride(this.model)\n    }\n  }\n}\n","import {getFilePathPosition} from \"../utils\"\nimport {showRenameDialog} from \"../views/renameView\"\nimport {addCommand} from \"./registry\"\n\naddCommand(\"atom-text-editor\", \"typescript:rename-refactor\", (deps) => ({\n  description: \"Rename symbol under text cursor everywhere it is used\",\n  async didDispatch(editor) {\n    const location = getFilePathPosition(editor)\n    if (!location) return\n\n    const client = await deps.getClient(location.file)\n    const response = await client.execute(\"rename\", location)\n    const {info, locs} = response.body!\n\n    if (!info.canRename) {\n      atom.notifications.addInfo(\"AtomTS: Rename not available at cursor location\")\n      return\n    }\n\n    const newName = await showRenameDialog({\n      autoSelect: true,\n      title: \"Rename Variable\",\n      text: info.displayName,\n      onValidate: (newText): string => {\n        if (newText.replace(/\\s/g, \"\") !== newText.trim()) {\n          return \"The new variable must not contain a space\"\n        }\n        if (!newText.trim()) {\n          return \"If you want to abort : Press esc to exit\"\n        }\n        return \"\"\n      },\n    })\n\n    if (newName !== undefined) {\n      await deps.applyEdits(\n        locs.map((span) => ({\n          fileName: span.file,\n          textChanges: span.locs.map((loc) => ({...loc, newText: newName})),\n        })),\n      )\n    }\n  },\n}))\n","import {addCommand} from \"./registry\"\n\naddCommand(\"atom-workspace\", \"typescript:restart-all-servers\", (deps) => ({\n  description: \"Kill all tsserver instances. They will be auto-restarted\",\n  async didDispatch() {\n    deps.killAllServers()\n  },\n}))\n","import {addCommand} from \"./registry\"\n\naddCommand(\"atom-workspace\", \"typescript:return-from-declaration\", (deps) => ({\n  description: \"If used `go-to-declaration`, return to previous text cursor position\",\n  async didDispatch() {\n    await deps.histGoBack()\n  },\n}))\n\naddCommand(\"atom-workspace\", \"typescript:show-editor-position-history\", (deps) => ({\n  description: \"If used `go-to-declaration`, return to previous text cursor position\",\n  async didDispatch() {\n    await deps.histShowHistory()\n  },\n}))\n","import {addCommand} from \"./registry\"\n\naddCommand(\"atom-text-editor\", \"typescript:toggle-semantic-view\", (deps) => ({\n  description: \"Toggle semantic view outline\",\n  didDispatch() {\n    deps.toggleSemanticViewController()\n  },\n}))\n","import {addCommand} from \"./registry\"\n\naddCommand(\"atom-text-editor\", \"typescript:show-tooltip\", (deps) => ({\n  description: \"Show type tooltip at current text cursor position\",\n  async didDispatch(ed) {\n    return deps.showTooltipAt(ed)\n  },\n}))\n","import {addCommand} from \"./registry\"\n\naddCommand(\"atom-text-editor\", \"typescript:show-signature-help\", (deps) => ({\n  description: \"Show signature help tooltip at current text cursor position\",\n  async didDispatch(ed) {\n    return deps.showSigHelpAt(ed)\n  },\n}))\n\naddCommand(\"atom-text-editor\", \"typescript:hide-signature-help\", (deps) => ({\n  description: \"Hide the currently visible signature help\",\n  async didDispatch(ed, ignore) {\n    if (!deps.hideSigHelpAt(ed)) ignore()\n  },\n}))\n\naddCommand(\"atom-text-editor\", \"typescript:signature-help-next\", (deps) => ({\n  description: \"Show next signature help if available\",\n  async didDispatch(ed, ignore) {\n    if (!deps.rotateSigHelp(ed, +1)) ignore()\n  },\n}))\n\naddCommand(\"atom-text-editor\", \"typescript:signature-help-prev\", (deps) => ({\n  description: \"Show previous signature help if available\",\n  async didDispatch(ed, ignore) {\n    if (!deps.rotateSigHelp(ed, -1)) ignore()\n  },\n}))\n","import {addCommand} from \"./registry\"\n\naddCommand(\"atom-text-editor\", \"typescript:toggle-file-symbols\", (deps) => ({\n  description: \"Toggle view for finding file symbols\",\n  async didDispatch(editor) {\n    deps.toggleFileSymbolsView(editor)\n  },\n}))\n\naddCommand(\"atom-text-editor\", \"typescript:toggle-project-symbols\", (deps) => ({\n  description: \"Toggle view for finding file symbols\",\n  async didDispatch(editor) {\n    deps.toggleProjectSymbolsView(editor)\n  },\n}))\n","import * as etch from \"etch\"\nimport {handlePromise} from \"../../../../utils\"\nimport {BuildStatus} from \"./buildStatus\"\nimport type {TBuildStatus} from \"./buildStatus\"\nimport {ConfigPath} from \"./configPath\"\nimport {Tooltip} from \"./tooltip\"\nexport {TBuildStatus}\n\nexport interface TProgress {\n  max: number\n  value: number\n}\n\nexport interface Props extends JSX.Props {\n  clientVersion?: string\n  pending: Array<{title: string}>\n  tsConfigPath?: string\n  buildStatus?: TBuildStatus\n  progress: TProgress\n  visible: boolean\n}\n\nexport class StatusPanel implements JSX.ElementClass {\n  public props: Props\n\n  constructor(props: Partial<Props> = {}) {\n    this.props = {\n      visible: true,\n      pending: [],\n      progress: {max: 0, value: 0},\n      ...props,\n    }\n    etch.initialize(this)\n  }\n\n  public async update(props: Partial<Props>) {\n    this.props = {...this.props, ...props}\n    await etch.update(this)\n  }\n\n  public render() {\n    return (\n      <ts-status-panel className={this.props.visible ? \"\" : \"hide\"}>\n        {this.renderVersion()}\n        {this.renderPending()}\n        {this.renderConfigPath()}\n        {this.renderStatus()}\n        {this.renderProgress()}\n      </ts-status-panel>\n    )\n  }\n\n  public async destroy() {\n    await etch.destroy(this)\n  }\n\n  public dispose() {\n    handlePromise(this.destroy())\n  }\n\n  public async show() {\n    await this.update({visible: true})\n  }\n\n  public async hide() {\n    await this.update({visible: false})\n  }\n\n  private renderVersion(): JSX.Element | null {\n    if (this.props.clientVersion !== undefined) {\n      return <Tooltip title=\"Active TypeScript version\">{this.props.clientVersion}</Tooltip>\n    }\n    return null\n  }\n\n  private renderPending(): JSX.Element | null {\n    if (this.props.pending.length > 0) {\n      return (\n        <Tooltip\n          title={`Pending Requests: <ul>${this.props.pending\n            .map(({title}) => `<li>${title}</li>`)\n            .join(\"\")}</ul>`}\n          html={true}>\n          <span ref=\"pendingCounter\">{this.props.pending.length.toString()}</span>\n          <span\n            ref=\"pendingSpinner\"\n            className=\"loading loading-spinner-tiny inline-block\"\n            style={{marginLeft: \"5px\", opacity: \"0.5\", verticalAlign: \"sub\"}}\n          />\n        </Tooltip>\n      )\n    } else return null\n  }\n\n  private renderConfigPath(): JSX.Element | null {\n    if (this.props.tsConfigPath !== undefined) {\n      return <ConfigPath tsConfigPath={this.props.tsConfigPath} />\n    }\n    return null\n  }\n\n  private renderStatus(): JSX.Element | null {\n    if (this.props.buildStatus) {\n      return <BuildStatus buildStatus={this.props.buildStatus} />\n    }\n    return null\n  }\n\n  private renderProgress(): JSX.Element | null {\n    if (this.props.progress.value < this.props.progress.max) {\n      return (\n        <progress\n          style={{verticalAlign: \"baseline\"}}\n          className=\"inline-block\"\n          max={this.props.progress.max}\n          value={this.props.progress.value}\n        />\n      )\n    }\n    return null\n  }\n}\n","import {CompositeDisposable} from \"atom\"\nimport * as etch from \"etch\"\nimport {debounce} from \"lodash\"\nimport {handlePromise} from \"../../../../utils\"\nimport {Tooltip} from \"./tooltip\"\n\nexport type TBuildStatus = {success: true} | {success: false; message: string}\n\nexport interface Props extends JSX.Props {\n  buildStatus: TBuildStatus\n}\n\nexport class BuildStatus implements JSX.ElementClass {\n  public props: Props\n  private hiddenBuildStatus = false\n  private disposables = new CompositeDisposable()\n  private hideBuildStatus!: () => void\n\n  constructor(props: Props) {\n    this.props = {\n      ...props,\n    }\n    this.setHideBuildStatus(atom.config.get(\"atom-typescript-updated\").buildStatusTimeout)\n    this.resetBuildStatusTimeout()\n    etch.initialize(this)\n    this.disposables.add(\n      atom.config.onDidChange(\"atom-typescript-updated.buildStatusTimeout\", ({newValue}) => {\n        this.setHideBuildStatus(newValue)\n        handlePromise(this.update({}))\n      }),\n    )\n  }\n\n  public async update(props: Partial<Props>) {\n    const successStateChanged =\n      props.buildStatus !== undefined &&\n      props.buildStatus.success !== this.props.buildStatus.success\n    this.props = {...this.props, ...props}\n    if (successStateChanged) this.resetBuildStatusTimeout()\n    await etch.update(this)\n  }\n\n  public render() {\n    if (this.hiddenBuildStatus) return <span />\n\n    let cls: string\n    let text: string\n    if (this.props.buildStatus.success) {\n      cls = \"highlight-success\"\n      text = \"Emit Success\"\n    } else {\n      cls = \"highlight-error\"\n      text = \"Emit Failed\"\n    }\n    return (\n      <Tooltip\n        title={\n          this.props.buildStatus.success\n            ? \"Build was successful\"\n            : \"Build failed; click to show error message\"\n        }>\n        <span className={cls} on={{click: this.buildStatusClicked}}>\n          {text}\n        </span>\n      </Tooltip>\n    )\n  }\n\n  public async destroy() {\n    await etch.destroy(this)\n  }\n\n  private buildStatusClicked = () => {\n    if (!this.props.buildStatus.success) {\n      atom.notifications.addError(\"Build failed\", {\n        detail: this.props.buildStatus.message,\n        dismissable: true,\n      })\n    }\n  }\n\n  private resetBuildStatusTimeout() {\n    this.hiddenBuildStatus = false\n    if (this.props.buildStatus.success) {\n      this.hideBuildStatus()\n    }\n  }\n\n  private setHideBuildStatus(value: number) {\n    if (value > 0) {\n      this.hideBuildStatus = debounce(() => {\n        this.hiddenBuildStatus = true\n        handlePromise(etch.update(this))\n      }, value * 1000)\n    } else if (value === 0) {\n      this.hideBuildStatus = () => {\n        this.hiddenBuildStatus = true\n      }\n    } else this.hideBuildStatus = () => {}\n  }\n}\n","import {DisposableLike, TooltipPlacement} from \"atom\"\nimport * as etch from \"etch\"\n\nexport interface Props extends JSX.Props {\n  title?: string | (() => string)\n  html?: boolean\n  keyBindingCommand?: string\n  keyBindingTarget?: HTMLElement\n  class?: string\n  placement?: TooltipPlacement | (() => TooltipPlacement)\n  trigger?: \"click\" | \"hover\" | \"focus\" | \"manual\"\n  delay?: {show: number; hide: number}\n}\n\nexport class Tooltip implements JSX.ElementClass {\n  public props: Props\n  public element!: HTMLElement\n  private tooltipDisposable: DisposableLike\n\n  constructor(props: Props, private children?: JSX.Element[]) {\n    this.props = {\n      ...props,\n      delay: {show: 0, hide: 0},\n    }\n    etch.initialize(this)\n\n    this.tooltipDisposable = atom.tooltips.add(this.element, this.props)\n  }\n\n  public async update(props: Partial<Props>, children: JSX.Element[]) {\n    this.props = {...this.props, ...props}\n    this.children = children\n    await etch.update(this)\n    this.tooltipDisposable.dispose()\n    this.tooltipDisposable = atom.tooltips.add(this.element, this.props)\n  }\n\n  public render() {\n    return <div className=\"inline-block\">{this.children ? this.children : null}</div>\n  }\n\n  public async destroy() {\n    await etch.destroy(this)\n    this.tooltipDisposable.dispose()\n  }\n}\n","import * as etch from \"etch\"\nimport {dirname} from \"path\"\nimport {handlePromise} from \"../../../../utils\"\nimport {Tooltip} from \"./tooltip\"\n\nexport interface Props extends JSX.Props {\n  tsConfigPath: string\n}\n\nexport class ConfigPath implements JSX.ElementClass {\n  public props: Props\n  public element!: HTMLElement\n\n  constructor(props: Props) {\n    this.props = {\n      ...props,\n    }\n    etch.initialize(this)\n  }\n\n  public async update(props: Partial<Props>) {\n    this.props = {...this.props, ...props}\n    await etch.update(this)\n  }\n\n  public render() {\n    return (\n      <Tooltip\n        title={() =>\n          this.props.tsConfigPath.startsWith(\"/dev/null\")\n            ? \"No tsconfig.json\"\n            : `Click to open ${atom.project.relativize(this.props.tsConfigPath)}`\n        }>\n        <a\n          className=\"inline-block\"\n          href=\"\"\n          on={{\n            click: (evt) => {\n              evt.preventDefault()\n              this.openConfigPath()\n            },\n          }}>\n          {this.props.tsConfigPath.startsWith(\"/dev/null\")\n            ? \"No project\"\n            : dirname(getFilePathRelativeToAtomProject(this.props.tsConfigPath))}\n        </a>\n      </Tooltip>\n    )\n  }\n\n  public async destroy() {\n    await etch.destroy(this)\n  }\n\n  private openConfigPath() {\n    if (!this.props.tsConfigPath.startsWith(\"/dev/null\")) {\n      handlePromise(atom.workspace.open(this.props.tsConfigPath))\n    } else {\n      atom.notifications.addInfo(\"No tsconfig for current file\")\n    }\n  }\n}\n\n/**\n * converts \"c:\\dev\\somethin\\bar.ts\" to \"~something\\bar\".\n */\nfunction getFilePathRelativeToAtomProject(filePath: string) {\n  return \"~\" + atom.project.relativize(filePath)\n}\n","import {TextEditor} from \"atom\"\nimport * as etch from \"etch\"\nimport {FileLocationQuery, getFilePathPosition} from \"./utils\"\nimport {HighlightComponent} from \"./views/highlightComponent\"\nimport {selectListView} from \"./views/simpleSelectionView\"\n\nexport interface OpenParams {\n  file: string\n  start: {line: number; offset: number}\n}\n\nexport class EditorPositionHistoryManager {\n  constructor(private prevCursorPositions: FileLocationQuery[] = []) {}\n\n  public async goBack(): Promise<object | undefined> {\n    return this.goHistory(1)\n  }\n\n  public async goHistory(depth: number): Promise<object | undefined> {\n    let position\n    while (depth-- > 0) position = this.prevCursorPositions.pop()\n    if (!position) {\n      atom.notifications.addInfo(\"AtomTS: Previous position not found.\")\n      return\n    }\n    return this.open({\n      file: position.file,\n      start: {line: position.line, offset: position.offset},\n    })\n  }\n\n  public async goForward(currentEditor: TextEditor, item: OpenParams): Promise<object> {\n    const location = getFilePathPosition(currentEditor)\n    if (location) {\n      this.prevCursorPositions.push(location)\n      const maxItems = 100\n      if (this.prevCursorPositions.length > maxItems) {\n        this.prevCursorPositions.splice(0, this.prevCursorPositions.length - maxItems)\n      }\n    }\n    return this.open(item)\n  }\n\n  public async showHistory() {\n    const res = await selectListView({\n      items: this.getHistory()\n        .slice()\n        .reverse()\n        .map((item, idx) => ({...item, idx})),\n      itemTemplate: (item, ctx) => (\n        <li className=\"two-lines\">\n          <div className=\"primary-line\">\n            <HighlightComponent label={item.file} query={ctx.getFilterQuery()} />\n          </div>\n          <div className=\"secondary-line\">\n            Line: {item.line}, column: {item.offset}\n          </div>\n        </li>\n      ),\n      itemFilterKey: \"file\",\n    })\n    if (res) await this.goHistory(res.idx + 1)\n  }\n\n  public getHistory() {\n    return this.prevCursorPositions\n  }\n\n  public dispose() {\n    // NOOP\n  }\n\n  public serialize() {\n    return this.prevCursorPositions\n  }\n\n  private async open(item: OpenParams): Promise<object> {\n    const editor = await atom.workspace.open(item.file, {\n      initialLine: item.start.line - 1,\n      initialColumn: item.start.offset - 1,\n      searchAllPanes: true,\n    })\n    if (atom.workspace.isTextEditor(editor)) {\n      editor.scrollToCursorPosition({center: true})\n    }\n    return editor\n  }\n}\n","import {CompositeDisposable} from \"atom\"\nimport {Disposable} from \"atom\"\nimport {GetClientFunction} from \"../../../../client\"\nimport {handlePromise} from \"../../../../utils\"\nimport {SemanticView, SEMANTIC_VIEW_URI} from \"./semanticView\"\n\nexport class SemanticViewController {\n  private view?: SemanticView\n  private subscriptions: CompositeDisposable\n\n  constructor(private getClient: GetClientFunction) {\n    this.subscriptions = new CompositeDisposable()\n\n    const pane = atom.workspace.paneForURI(SEMANTIC_VIEW_URI)\n    if (pane) this.view = pane.itemForURI(SEMANTIC_VIEW_URI) as SemanticView | undefined\n    if (this.view) handlePromise(this.view.setGetClient(this.getClient))\n\n    this.subscriptions.add(\n      new Disposable(() => {\n        if (this.view) {\n          atom.workspace.hide(this.view)\n          handlePromise(this.view.destroy())\n        }\n      }),\n      atom.config.observe(\"atom-typescript-updated.showSemanticView\", (val) => {\n        if (val) handlePromise(this.show())\n        else this.hide()\n      }),\n    )\n  }\n\n  public dispose() {\n    this.subscriptions.dispose()\n  }\n\n  public async toggle(): Promise<void> {\n    if (!this.view) await this.show()\n    else await atom.workspace.toggle(this.view)\n  }\n\n  private async show(): Promise<void> {\n    if (!this.view) {\n      this.view = SemanticView.create({navTree: null})\n      await this.view.setGetClient(this.getClient)\n    }\n\n    await atom.workspace.open(this.view, {searchAllPanes: true})\n  }\n\n  private hide(): boolean {\n    if (!this.view) return false\n    else return atom.workspace.hide(this.view)\n  }\n}\n","import {TextEditor} from \"atom\"\nimport {handlePromise} from \"../../../../utils\"\nimport {Deps} from \"./deps\"\nimport {toggle as toggleFileView} from \"./fileSymbolsView\"\nimport {toggle as toggleProjectView} from \"./projectSymbolsView\"\n\nexport class SymbolsViewController {\n  constructor(private deps: Deps) {}\n\n  public toggleFileView(editor: TextEditor) {\n    handlePromise(toggleFileView(editor, this.deps))\n  }\n\n  public toggleProjectView(editor: TextEditor) {\n    handlePromise(toggleProjectView(editor, this.deps))\n  }\n\n  public dispose() {\n    // TODO: proper disposal\n  }\n}\n","import {TextEditor} from \"atom\"\nimport * as etch from \"etch\"\nimport {HighlightComponent} from \"../highlightComponent\"\nimport {selectListView} from \"../simpleSelectionView\"\nimport {Deps} from \"./deps\"\nimport {generateFile} from \"./generator\"\nimport {Tag} from \"./symbolsTag\"\nimport * as utils from \"./utils\"\n\nexport async function toggle(editor: TextEditor, deps: Deps) {\n  const filePath = editor.getPath()\n  if (filePath !== undefined) {\n    // NOTE uses the \"parent\" package's setting (i.e. from symbols-view):\n    let initialState\n    if (atom.config.get(\"symbols-view.quickJumpToFileSymbol\")) {\n      initialState = utils.serializeEditorState(editor)\n    }\n    const tag = await selectListView({\n      items: generateFile(filePath, deps),\n      itemTemplate: ({name, position}, ctx) => (\n        <li className=\"two-lines\">\n          <div className=\"primary-line\">\n            <HighlightComponent label={name} query={ctx.getFilterQuery()} />\n          </div>\n          <div className=\"secondary-line\">{`Line ${position.row + 1}`}</div>\n        </li>\n      ),\n      didChangeSelection(item?: Tag) {\n        // NOTE uses the \"parent\" package's setting (i.e. from symbols-view):\n        if (atom.config.get(\"symbols-view.quickJumpToFileSymbol\") && item) {\n          editor.setCursorBufferPosition(item.position)\n        }\n      },\n      itemFilterKey: \"name\",\n    })\n    if (tag) await utils.openTag(tag, editor, deps.histGoForward)\n    else if (initialState) utils.deserializeEditorState(editor, initialState)\n  }\n}\n","import {NavigationTree, NavtoItem} from \"typescript/lib/protocol\"\nimport {Deps} from \"./deps\"\nimport {Tag} from \"./symbolsTag\"\n\nexport async function generateFile(filePath: string, deps: Deps) {\n  const navtree = await getNavTree(filePath, deps)\n  if (navtree && navtree.childItems) {\n    // NOTE omit root NavigationTree tree element (which corresponds to the file itself)\n    return Array.from(parseNavTree(navtree.childItems))\n  } else return []\n}\n\nexport async function generateProject(filePath: string, search: string, deps: Deps) {\n  const navtree = await getNavTo(filePath, search, deps)\n  if (navtree) {\n    return Array.from(parseNavTo(navtree))\n  } else return []\n}\n\nfunction* parseNavTree(navTree: NavigationTree[], parent?: Tag): IterableIterator<Tag> {\n  navTree.sort((a, b) => a.spans[0].start.line - b.spans[0].start.line)\n  for (const item of navTree) {\n    const tag = Tag.fromNavTree(item, parent)\n    yield tag\n    if (item.childItems) yield* parseNavTree(item.childItems, tag)\n  }\n}\n\nfunction* parseNavTo(navTree: NavtoItem[], parent?: Tag) {\n  for (const item of navTree) {\n    yield Tag.fromNavto(item, parent)\n  }\n}\n\nasync function getNavTree(filePath: string, deps: Deps) {\n  try {\n    const client = await deps.getClient(filePath)\n    const navtreeResult = await client.execute(\"navtree\", {file: filePath})\n    return navtreeResult.body\n  } catch (e) {\n    console.error(filePath, e)\n  }\n}\n\nasync function getNavTo(filePath: string, search: string, deps: Deps) {\n  try {\n    const client = await deps.getClient(filePath)\n    const navtoResult = await client.execute(\"navto\", {\n      file: filePath,\n      currentFileOnly: false,\n      searchValue: search,\n      maxResultCount: 1000,\n    })\n    return navtoResult.body\n  } catch (e) {\n    console.error(filePath, e)\n  }\n}\n","import {NavigationTree, NavtoItem} from \"typescript/lib/protocol\"\n\nexport class Tag {\n  public static fromNavTree(navTree: NavigationTree, parent?: Tag | null) {\n    const start = navTree.spans[0].start\n    return new Tag({\n      name: navTree.text,\n      type: navTree.kind,\n      position: {row: start.line - 1, column: start.offset - 1},\n      parent: parent != null ? parent : null,\n    })\n  }\n\n  public static fromNavto(navTo: NavtoItem, parent?: Tag | null) {\n    const start = navTo.start\n    return new Tag({\n      name: navTo.name,\n      type: navTo.kind,\n      position: {row: start.line - 1, column: start.offset - 1},\n      parent: parent != null ? parent : null,\n      file: navTo.file,\n    })\n  }\n\n  public position: {row: number; column: number}\n  public name: string\n  public type: string\n  public parent: Tag | null\n  public file?: string\n\n  private constructor(props: {\n    position: {row: number; column: number}\n    name: string\n    type: string\n    parent: Tag | null\n    file?: string\n  }) {\n    this.position = props.position\n    this.name = props.name\n    this.type = props.type\n    this.parent = props.parent\n    this.file = props.file\n  }\n}\n","import {TextEditor} from \"atom\"\nimport {EditorPositionHistoryManager} from \"../../editorPositionHistoryManager\"\nimport {Tag} from \"./symbolsTag\"\n\nexport async function openTag(\n  tag: Tag,\n  editor: TextEditor,\n  histGoForward: EditorPositionHistoryManager[\"goForward\"],\n) {\n  if (tag.file !== undefined) {\n    return histGoForward(editor, {\n      file: tag.file,\n      start: {\n        line: tag.position.row + 1,\n        offset: tag.position.column + 1,\n      },\n    })\n  }\n}\n\nexport function serializeEditorState(editor: TextEditor) {\n  const editorElement = atom.views.getView(editor)\n  const scrollTop = editorElement.getScrollTop()\n\n  return {\n    bufferRanges: editor.getSelectedBufferRanges(),\n    scrollTop,\n  }\n}\n\nexport function deserializeEditorState(\n  editor: TextEditor,\n  {bufferRanges, scrollTop}: ReturnType<typeof serializeEditorState>,\n) {\n  const editorElement = atom.views.getView(editor)\n  editor.setSelectedBufferRanges(bufferRanges)\n  editorElement.setScrollTop(scrollTop)\n}\n","import {TextEditor} from \"atom\"\nimport * as etch from \"etch\"\nimport {HighlightComponent} from \"../highlightComponent\"\nimport {selectListView} from \"../simpleSelectionView\"\nimport {Deps} from \"./deps\"\nimport {generateProject} from \"./generator\"\nimport * as utils from \"./utils\"\n\nexport async function toggle(editor: TextEditor, deps: Deps) {\n  const filePath = editor.getPath()\n  if (filePath !== undefined) {\n    const tag = await selectListView({\n      items: (search: string) => generateProject(filePath, search, deps),\n      itemTemplate({name, position, file}, ctx) {\n        const relfile = atom.project.relativize(file!)\n        return (\n          <li className=\"two-lines\">\n            <div className=\"primary-line\">\n              <HighlightComponent label={name} query={ctx.getFilterQuery()} />\n            </div>\n            <div className=\"secondary-line\">{`File ${relfile} line ${position.row + 1}`}</div>\n          </li>\n        )\n      },\n      itemFilterKey: \"name\",\n    })\n    if (tag) await utils.openTag(tag, editor, deps.histGoForward)\n  }\n}\n","import {ConfigValues, Point, Range} from \"atom\"\nimport {IndieDelegate, Message} from \"atom/linter\"\nimport {debounce} from \"lodash\"\nimport * as path from \"path\"\nimport {Diagnostic} from \"typescript/lib/protocol\"\nimport {DiagnosticTypes} from \"../client/clientResolver\"\nimport {\n  checkDiagnosticCategory,\n  DiagnosticCategory,\n  locationsToRange,\n  spanToRange,\n} from \"./atom/utils\"\n\n/** Class that collects errors from all of the clients and pushes them to the Linter service */\nexport class ErrorPusher {\n  private linter?: IndieDelegate\n  private errors = new Map<DiagnosticTypes, Map<string, Diagnostic[]>>()\n  private fileGrammars = new Map<string, string>()\n\n  constructor() {\n    this.pushErrors = debounce(this.pushErrors.bind(this), 100)\n  }\n\n  public *getErrorsInRange(filePath: string, range: Range): IterableIterator<Diagnostic> {\n    for (const prefixed of this.errors.values()) {\n      const errors = prefixed.get(path.normalize(filePath))\n      if (errors) yield* errors.filter((err) => spanToRange(err).intersectsWith(range))\n    }\n  }\n\n  /** Return any errors that cover the given location */\n  public *getErrorsAt(filePath: string, loc: Point): IterableIterator<Diagnostic> {\n    for (const prefixed of this.errors.values()) {\n      const errors = prefixed.get(path.normalize(filePath))\n      if (errors) yield* errors.filter((err) => spanToRange(err).containsPoint(loc))\n    }\n  }\n\n  /** Set errors. Previous errors with the same prefix and filePath are going to be replaced */\n  public setErrors(prefix: DiagnosticTypes, filePath: string, errors: Diagnostic[]) {\n    let prefixed = this.errors.get(prefix)\n    if (!prefixed) {\n      prefixed = new Map()\n      this.errors.set(prefix, prefixed)\n    }\n\n    prefixed.set(path.normalize(filePath), errors)\n\n    this.pushErrors()\n  }\n\n  public clearFileErrors(filePath: string) {\n    for (const map of this.errors.values()) {\n      map.delete(filePath)\n    }\n    this.pushErrors()\n  }\n\n  public clear() {\n    if (!this.linter) return\n    this.linter.clearMessages()\n  }\n\n  public setLinter(linter: IndieDelegate) {\n    this.linter = linter\n    this.pushErrors()\n  }\n\n  public dispose() {\n    this.clear()\n    if (this.linter) this.linter.dispose()\n    this.linter = undefined\n  }\n\n  private pushErrors() {\n    if (this.linter) this.linter.setAllMessages(this.getLinterErrors())\n  }\n\n  private getLinterErrors(): Message[] {\n    if (atom.config.get(\"atom-typescript-updated.suppressAllDiagnostics\")) return []\n    const result: Message[] = []\n    for (const fileErrors of this.errors.values()) {\n      for (const [filePath, diagnostics] of fileErrors) {\n        const ed = atom.workspace.getTextEditors().find((x) => x.getPath() === filePath)\n        const scopeName = ed ? ed.getGrammar().scopeName : this.selectGrammar(filePath)\n        if (config(\"suppressAllDiagnostics\", scopeName)) continue\n        for (const diagnostic of diagnostics) {\n          if (config(\"ignoredDiagnosticCodes\", scopeName).includes(`${diagnostic.code}`)) continue\n          if (\n            config(\"ignoreUnusedSuggestionDiagnostics\", scopeName) &&\n            diagnostic.reportsUnnecessary\n          ) {\n            continue\n          }\n          if (\n            diagnostic.category === \"suggestion\" &&\n            config(\"ignoredSuggestionDiagnostics\", scopeName).includes(`${diagnostic.code}`)\n          ) {\n            continue\n          }\n          if (\n            config(\"ignoreNonSuggestionSuggestionDiagnostics\", scopeName) &&\n            diagnostic.category === \"suggestion\" &&\n            !checkDiagnosticCategory(diagnostic.code, DiagnosticCategory.Suggestion)\n          ) {\n            continue\n          }\n          // Add a bit of extra validation that we have the necessary locations since linter v2\n          // does not allow range-less messages anymore. This happens with configFileDiagnostics.\n          let {start, end} = diagnostic as Partial<Diagnostic>\n          if (!start || !end) {\n            start = end = {line: 1, offset: 1}\n          }\n\n          result.push({\n            severity: this.getSeverity(config(\"unusedAsInfo\", scopeName), diagnostic),\n            excerpt: diagnostic.text,\n            location: {\n              file: filePath,\n              position: locationsToRange(start, end),\n            },\n          })\n        }\n      }\n    }\n\n    return result\n  }\n\n  private selectGrammar(filePath: string): string {\n    const knownGramamr = this.fileGrammars.get(filePath)\n    if (knownGramamr !== undefined) return knownGramamr\n    const selectedGrammar = atom.grammars.selectGrammar(filePath, \"\").scopeName\n    this.fileGrammars.set(filePath, selectedGrammar)\n    return selectedGrammar\n  }\n\n  private getSeverity(unusedAsInfo: boolean, diagnostic: Diagnostic) {\n    if (unusedAsInfo && diagnostic.code === 6133) return \"info\"\n    switch (diagnostic.category) {\n      case \"error\":\n        return \"error\"\n      case \"warning\":\n        return \"warning\"\n      default:\n        return \"info\"\n    }\n  }\n}\n\nfunction config<T extends keyof ConfigValues[\"atom-typescript-updated\"]>(\n  option: T,\n  scope: string,\n): ConfigValues[\"atom-typescript-updated\"][typeof option] {\n  return atom.config.get(`atom-typescript-updated.${option}`, {scope: [scope]}) as any\n}\n","import * as Atom from \"atom\"\nimport {CompositeDisposable} from \"atom\"\nimport {GetClientFunction} from \"../client\"\nimport {handlePromise} from \"../utils\"\nimport {TBuildStatus} from \"./atom/components/statusPanel\"\nimport {isTypescriptEditorWithPath} from \"./atom/utils\"\nimport {TypescriptBuffer} from \"./typescriptBuffer\"\n\ninterface PaneOptions {\n  getClient: GetClientFunction\n  reportClientInfo: (info: {clientVersion: string; tsConfigPath: string | undefined}) => void\n  reportBuildStatus: (status: TBuildStatus | undefined) => void\n  clearFileErrors: (filePath: string) => void\n}\n\nexport class TypescriptEditorPane {\n  private static editorMap = new WeakMap<Atom.TextEditor, TypescriptEditorPane>()\n  public static createFactory(\n    opts: PaneOptions,\n  ): (editor: Atom.TextEditor) => TypescriptEditorPane {\n    return (editor: Atom.TextEditor) => {\n      let tep = TypescriptEditorPane.editorMap.get(editor)\n      if (!tep) {\n        tep = new TypescriptEditorPane(editor, opts)\n        TypescriptEditorPane.editorMap.set(editor, tep)\n      }\n      return tep\n    }\n  }\n  public static lookupPane(editor: Atom.TextEditor): TypescriptEditorPane | undefined {\n    return TypescriptEditorPane.editorMap.get(editor)\n  }\n\n  private readonly buffer: TypescriptBuffer\n\n  private readonly subscriptions = new CompositeDisposable()\n  private isTypescript = false\n\n  private constructor(private readonly editor: Atom.TextEditor, private opts: PaneOptions) {\n    this.buffer = TypescriptBuffer.create(editor.getBuffer(), opts)\n    this.subscriptions.add(this.buffer.on(\"opened\", this.onOpened))\n\n    this.checkIfTypescript()\n\n    this.subscriptions.add(\n      editor.onDidChangePath(this.checkIfTypescript),\n      editor.onDidChangeGrammar(this.checkIfTypescript),\n      editor.onDidDestroy(this.destroy),\n      editor.onDidSave(() => {\n        if (atom.config.get(\"atom-typescript-updated.checkAllFilesOnSave\")) {\n          atom.commands.dispatch(atom.views.getView(editor), \"typescript:check-all-files\")\n        }\n      }),\n    )\n  }\n\n  public destroy = () => {\n    TypescriptEditorPane.editorMap.delete(this.editor)\n    atom.views.getView(this.editor).classList.remove(\"typescript-editor\")\n    this.subscriptions.dispose()\n    handlePromise(this.buffer.dispose())\n  }\n\n  /** NOTE:\n   * it is implicitly assumed that `atom.workspace.getActiveTextEditor() === this.editor`\n   * which has to be ensured at call site\n   */\n  public didActivate = () => {\n    if (this.isTypescript) this.reportInfo()\n  }\n\n  private onOpened = () => {\n    const isActive = atom.workspace.getActiveTextEditor() === this.editor\n    if (isActive) this.reportInfo()\n  }\n\n  private reportInfo() {\n    const info = this.buffer.getInfo()\n    if (info) this.opts.reportClientInfo(info)\n  }\n\n  private checkIfTypescript = () => {\n    this.isTypescript = isTypescriptEditorWithPath(this.editor)\n\n    if (this.isTypescript) {\n      atom.views.getView(this.editor).classList.add(\"typescript-editor\")\n    } else {\n      atom.views.getView(this.editor).classList.remove(\"typescript-editor\")\n    }\n  }\n}\n","import * as Atom from \"atom\"\nimport {debounce, DebouncedFunc, flatten} from \"lodash\"\nimport {GetClientFunction, TSClient} from \"../client\"\nimport {handlePromise} from \"../utils\"\nimport {TBuildStatus} from \"./atom/components/statusPanel\"\nimport {getOpenEditorsPaths, getProjectConfig, isTypescriptFile} from \"./atom/utils\"\n\nexport interface Deps {\n  getClient: GetClientFunction\n  clearFileErrors: (filePath: string) => void\n  reportBuildStatus: (status: TBuildStatus | undefined) => void\n}\n\nexport class TypescriptBuffer {\n  public static create(buffer: Atom.TextBuffer, deps: Deps) {\n    const b = TypescriptBuffer.bufferMap.get(buffer)\n    if (b) return b\n    else {\n      const nb = new TypescriptBuffer(buffer, deps)\n      TypescriptBuffer.bufferMap.set(buffer, nb)\n      return nb\n    }\n  }\n  private static bufferMap = new WeakMap<Atom.TextBuffer, TypescriptBuffer>()\n\n  private events = new Atom.Emitter<{opened: void}>()\n\n  private state?: {\n    client: TSClient\n    filePath: string\n    // Path to the project's tsconfig.json\n    configFile: Atom.File | undefined\n    subscriptions: Atom.CompositeDisposable\n  }\n  private compileOnSave: boolean = false\n\n  private subscriptions = new Atom.CompositeDisposable()\n  private openPromise: Promise<void>\n\n  public on = this.events.on.bind(this.events)\n\n  private constructor(public buffer: Atom.TextBuffer, private deps: Deps) {\n    let debouncedGetErr: DebouncedFunc<() => void>\n    this.subscriptions.add(\n      atom.config.observe(\"atom-typescript-updated.getErrDebounceTimeout\", (val) => {\n        debouncedGetErr = debounce(() => {\n          handlePromise(this.getErr({allFiles: false, delay: 0}))\n        }, val)\n      }),\n      buffer.onDidChangePath(this.onDidChangePath),\n      buffer.onDidDestroy(() => {\n        handlePromise(this.dispose())\n      }),\n      buffer.onDidSave(() => {\n        handlePromise(this.onDidSave())\n      }),\n      buffer.onDidStopChanging(({changes}) => {\n        if (changes.length > 0) this.deps.reportBuildStatus(undefined)\n      }),\n      buffer.onDidChangeText((arg) => {\n        // NOTE: we don't need to worry about interleaving here,\n        // because onDidChangeText pushes all changes at once\n        handlePromise(this.onDidChangeText(arg))\n        debouncedGetErr()\n      }),\n    )\n\n    this.openPromise = this.open(this.buffer.getPath())\n  }\n\n  public dispose = async () => {\n    TypescriptBuffer.bufferMap.delete(this.buffer)\n    this.subscriptions.dispose()\n    await this.close()\n  }\n\n  public getPath() {\n    return this.state && this.state.filePath\n  }\n\n  public getInfo() {\n    if (!this.state) return\n    return {\n      clientVersion: this.state.client.version,\n      tsConfigPath: this.state.configFile && this.state.configFile.getPath(),\n    }\n  }\n\n  private async getErr(opts: {allFiles: boolean; delay: number}) {\n    if (!this.state) return\n    const files = opts.allFiles ? Array.from(getOpenEditorsPaths()) : [this.state.filePath]\n    await this.state.client.execute(\"geterr\", {\n      files,\n      delay: opts.delay,\n    })\n  }\n\n  /** Throws! */\n  private async compile() {\n    if (!this.state) return\n    const {client, filePath} = this.state\n    const result = await client.execute(\"compileOnSaveAffectedFileList\", {\n      file: filePath,\n    })\n    const fileNames = flatten(result.body.map((project) => project.fileNames))\n\n    if (fileNames.length === 0) return\n\n    const promises = fileNames.map((file) => client.execute(\"compileOnSaveEmitFile\", {file}))\n    const saved = await Promise.all(promises)\n\n    if (!saved.every((res) => !!res.body)) {\n      throw new Error(\"Some files failed to emit\")\n    }\n  }\n\n  private async doCompileOnSave() {\n    if (!this.compileOnSave) return\n    this.deps.reportBuildStatus(undefined)\n    try {\n      await this.compile()\n      this.deps.reportBuildStatus({success: true})\n    } catch (error) {\n      const e = error as Error\n      console.error(\"Save failed with error\", e)\n      this.deps.reportBuildStatus({success: false, message: e.message})\n    }\n  }\n\n  private async open(filePath: string | undefined) {\n    if (filePath !== undefined && isTypescriptFile(filePath)) {\n      const client = await this.deps.getClient(filePath)\n\n      this.state = {\n        client,\n        filePath,\n        configFile: undefined,\n        subscriptions: new Atom.CompositeDisposable(),\n      }\n\n      this.state.subscriptions.add(client.on(\"restarted\", () => handlePromise(this.init())))\n\n      await this.init()\n\n      const result = await client.execute(\"projectInfo\", {\n        needFileNameList: false,\n        file: filePath,\n      })\n\n      // TODO: wrong type here, complain on TS repo\n      if ((result.body!.configFileName as string | undefined) !== undefined) {\n        this.state.configFile = new Atom.File(result.body!.configFileName)\n        await this.readConfigFile()\n        this.state.subscriptions.add(\n          this.state.configFile.onDidChange(() => handlePromise(this.readConfigFile())),\n        )\n      }\n\n      this.events.emit(\"opened\")\n    } else {\n      return this.close()\n    }\n  }\n\n  private async readConfigFile() {\n    if (!this.state || !this.state.configFile) return\n    const options = getProjectConfig(this.state.configFile.getPath())\n    this.compileOnSave = options.compileOnSave\n    const cfg = atom.config.get(\"atom-typescript-updated\")\n    await this.state.client.execute(\"configure\", {\n      file: this.state.filePath,\n      formatOptions: options.formatCodeOptions,\n      preferences: {\n        includeCompletionsWithInsertText: true,\n        includeCompletionsForModuleExports: cfg.includeCompletionsForModuleExports,\n        quotePreference: cfg.quotePreference,\n        importModuleSpecifierEnding: cfg.importModuleSpecifierEnding,\n        importModuleSpecifierPreference:\n          cfg.importModuleSpecifierPreference === \"auto\"\n            ? undefined\n            : cfg.importModuleSpecifierPreference,\n        ...options.preferences,\n      },\n    })\n  }\n\n  private init = async () => {\n    if (!this.state) return\n    await this.state.client.execute(\"open\", {\n      file: this.state.filePath,\n      fileContent: this.buffer.getText(),\n    })\n\n    handlePromise(this.getErr({allFiles: false, delay: 0}))\n  }\n\n  private close = async () => {\n    await this.openPromise\n    if (this.state) {\n      const client = this.state.client\n      const file = this.state.filePath\n      this.deps.clearFileErrors(file)\n      this.state.subscriptions.dispose()\n      this.state = undefined\n      await client.execute(\"close\", {file})\n    }\n  }\n\n  private onDidChangePath = (newPath: string) => {\n    handlePromise(\n      this.close().then(() => {\n        this.openPromise = this.open(newPath)\n      }),\n    )\n  }\n\n  private onDidSave = async () => {\n    await Promise.all([this.getErr({allFiles: true, delay: 100}), this.doCompileOnSave()])\n  }\n\n  private onDidChangeText = async ({changes}: {changes: ReadonlyArray<Atom.TextChange>}) => {\n    // If there are no actual changes, or the file isn't open, we have nothing to do\n    if (changes.length === 0 || !this.state) return\n\n    const {client, filePath} = this.state\n\n    // NOTE: this might look somewhat weird until we realize that\n    // awaiting on each \"change\" command may lead to arbitrary\n    // interleaving, while pushing them all at once guarantees\n    // that all subsequent \"change\" commands will be sequenced after\n    // the ones we pushed\n    await Promise.all(\n      changes.reduceRight<Array<Promise<void>>>((acc, {oldRange, newText}) => {\n        acc.push(\n          client.execute(\"change\", {\n            file: filePath,\n            line: oldRange.start.row + 1,\n            offset: oldRange.start.column + 1,\n            endLine: oldRange.end.row + 1,\n            endOffset: oldRange.end.column + 1,\n            insertString: newText,\n          }),\n        )\n        return acc\n      }, []),\n    )\n  }\n}\n"],"names":[],"version":3,"file":"main.js.map","sourceRoot":"../"}